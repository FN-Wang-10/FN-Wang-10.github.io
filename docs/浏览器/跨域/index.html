<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-浏览器/跨域" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">跨域 | fn-wang-10.github.io</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fn-wang-10.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://fn-wang-10.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://fn-wang-10.github.io/docs/浏览器/跨域"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="跨域 | fn-wang-10.github.io"><meta data-rh="true" name="description" content="跨域问题是由于浏览器的同源策略引起的，当一个请求的协议、域名或端口与当前页面不一致时，浏览器会拒绝接收响应。虽然服务器已经处理并响应了请求，但浏览器为了用户的安全，会单方面拒绝响应。"><meta data-rh="true" property="og:description" content="跨域问题是由于浏览器的同源策略引起的，当一个请求的协议、域名或端口与当前页面不一致时，浏览器会拒绝接收响应。虽然服务器已经处理并响应了请求，但浏览器为了用户的安全，会单方面拒绝响应。"><link data-rh="true" rel="icon" href="/img/logo.ico"><link data-rh="true" rel="canonical" href="https://fn-wang-10.github.io/docs/浏览器/跨域"><link data-rh="true" rel="alternate" href="https://fn-wang-10.github.io/docs/浏览器/跨域" hreflang="en"><link data-rh="true" rel="alternate" href="https://fn-wang-10.github.io/docs/浏览器/跨域" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="fn-wang-10.github.io RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="fn-wang-10.github.io Atom Feed"><link rel="stylesheet" href="/assets/css/styles.4daee39b.css">
<script src="/assets/js/runtime~main.1ba5ce3c.js" defer="defer"></script>
<script src="/assets/js/main.e6e7c638.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.ico" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.ico" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">fn-wang-10</b></a><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/CDN">CDN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/CDN是什么，怎么实现">CDN是什么，怎么实现</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/DNS">DNS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/DNS协议 是什么DNS 完整的查询过程">DNS协议 是什么DNS 完整的查询过程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/JSONP的原理">JSONP的原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/url到页面呈现，发生了什么">url到页面呈现，发生了什么</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/从输入url到看到页面经历的所有事情">从输入url到看到页面经历的所有事情</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/内存泄漏">内存泄漏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/几种浏览器存储方法及其优缺点">几种浏览器存储方法及其优缺点</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/地址栏输入URL敲下回车后所有动作">地址栏输入URL敲下回车后所有动作</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/垃圾回收机制">垃圾回收机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/夸标签页通信">夸标签页通信</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/">浏览器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/浏览器内核">浏览器内核</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/浏览器如何实现断点续传">浏览器如何实现断点续传</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/浏览器渲染页面的过程">浏览器渲染页面的过程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/浏览器的缓存机制">浏览器的缓存机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/浏览器缓存机制">浏览器缓存机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/浏览器/跨域">跨域</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/跨域形成原因以及解决方案">跨域形成原因以及解决方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/浏览器/重绘和回流">重绘和回流</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">跨域</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>跨域</h1></header><p>跨域问题是由于浏览器的同源策略引起的，当一个请求的协议、域名或端口与当前页面不一致时，浏览器会拒绝接收响应。虽然服务器已经处理并响应了请求，但浏览器为了用户的安全，会单方面拒绝响应。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一跨域的原因">一、跨域的原因<a href="#一跨域的原因" class="hash-link" aria-label="Direct link to 一、跨域的原因" title="Direct link to 一、跨域的原因">​</a></h2>
<p>跨域是浏览器的<code>同源策略</code>引起的</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="同源策略">同源策略<a href="#同源策略" class="hash-link" aria-label="Direct link to 同源策略" title="Direct link to 同源策略">​</a></h3>
<p>同源策略是浏览器最核心最基本的安全功能，如果缺少了同源策略，会存在一切安全风险，如 CSRF(跨站请求伪造)、XSS(跨站脚本攻击) 等攻击</p>
<p>跨域只会存在于浏览器，服务器不存在跨域问题</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="哪些情况下产生跨域">哪些情况下产生跨域<a href="#哪些情况下产生跨域" class="hash-link" aria-label="Direct link to 哪些情况下产生跨域" title="Direct link to 哪些情况下产生跨域">​</a></h3>
<ol>
<li>协议不同产生跨域(http/https)</li>
<li>域名不同产生跨域</li>
<li>端口不同产生跨域</li>
<li>域名和域名对应的 ip 地址产生跨域(比如：localhost 和 127.0.0.1 产生跨域)</li>
<li>一级域名和二级域名产生跨域</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="何为同源  请求">何为同源请求？<a href="#何为同源请求" class="hash-link" aria-label="Direct link to 何为同源请求？" title="Direct link to 何为同源请求？">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/cross13-90d078bffe9bc400f8a998298ad77681.png" width="413" height="322" class="img_ev3q"></p>
<p>同源请求不止针对 Ajax，对其他类型的如请求图片、JS 文件、CSS 等，只不过对 Ajax 的限制较为厉害而已</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="浏览器如何限制">浏览器如何限制？<a href="#浏览器如何限制" class="hash-link" aria-label="Direct link to 浏览器如何限制？" title="Direct link to 浏览器如何限制？">​</a></h3>
<p>对标签元素发出的跨域请求轻微限制</p>
<p>对 Ajax 发出的跨域请求严厉限制</p>
<p>对 Ajax 的限制如图：</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="351" height="300" class="img_ev3q"></p>
<p>这里跨域的发生地方在收到响应时；浏览器是发出请求了的，同时服务端也接收到了请求，而且返回了响应，只不过这个响应被浏览器拦截了，因为有安全因素考虑，会对响应做出校验，通过了就没有跨域问题了，没有校验通过就会引发错误产生跨域问题了</p>
<p>比如在浏览器控制台发出一个异源请求，就会发生错误</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross14-53446d7e0be3ad1b83ee16bbe24f4c4b.png" width="611" height="174" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="二跨越解决方式">二、跨越解决方式<a href="#二跨越解决方式" class="hash-link" aria-label="Direct link to 二、跨越解决方式" title="Direct link to 二、跨越解决方式">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1jsonp">1.jsonp<a href="#1jsonp" class="hash-link" aria-label="Direct link to 1.jsonp" title="Direct link to 1.jsonp">​</a></h3>
<p>由于浏览器的同源策略限制，不允许跨域请求；但是页面中的 script、img、iframe 标签是例外，不受同源策略限制。</p>
<p>在没有 CORS 方法的年代，JSONP 就是最佳方法</p>
<p>在同源策略中，对标签的跨域请求限制较小，JSONP 就利用了这一点</p>
<p>在项目开发中常常会引入外链的图片、样式文件、插件等资源，但这些请求并没有导致跨域错误，因为这些请求都属于 http 请求 并不是会引发跨域 问题的 Xhr 请求<br>
<!-- -->简单来说 script 标签没有跨域限制的特性,把 script 脚本的 src 改成我需要跨域请求的 url,就能实现跨域获取资源，且不触发浏览器的同源策略，这就是 JSONP 的原理</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//前端</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function" style="color:#d73a49">callback</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script src </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27; http://127.0.0.1:8080/jsonp?username=111&amp;callback=callback&#x27;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//后端</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;express&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> router </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> express</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Router</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">express</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/jsonp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> callback</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> username </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">username </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;111&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> requestData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">code</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;登录成功&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">callback</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">(</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation constant" style="color:#36acaa">JSON</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation function" style="color:#d73a49">stringify</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation">requestData</span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">)</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">router</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">listen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;8080&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;api server running at http://127.0.0.1:8080&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上面的代码中我们事先定义一个用于获取跨域响应数据的回调函数并挂载到 window 对象上，通过没有同源策略限制的 script 标签发起一个请求（将回调函数的名称放到这个请求的 query 参数里），然后服务端返回这个回调函数的执行，并将需要响应的数据放到回调函数的参数里，前端的 script 标签请求到这个执行的回调函数后会立马执行，于是就拿到了执行的响应数据</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross-ab10014b59bdd712a2df7ce9636dbb4c.png" width="2401" height="134" class="img_ev3q"></p>
<p>我们还可以在前端对 JSONP 代码进行一层封装</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> requestData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">png</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">p3</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">juejin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">byteimg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tos</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cn</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">k3u1fbpfcp</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">6d4143371aed4f17a732a4d4b616f43f</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">tplv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">k3u1fbpfcp</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">jj</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">mark</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">q75</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image#</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">w</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1919</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">h</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">92</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">s</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7900</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">e</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">png</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">b</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ffffff</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://127.0.0.1:8080/jsonp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">username</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">111</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">jsonp</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;getMessage&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">jsonp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">requestData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 对传入参数进行处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jsonp </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requestData</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> query </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">query </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">key</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">data</span><span class="token template-string interpolation punctuation" style="color:#393A34">[</span><span class="token template-string interpolation">key</span><span class="token template-string interpolation punctuation" style="color:#393A34">]</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&amp;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> src </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">url</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">?</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">query</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">jsonp=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">jsonp</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 生成、填充script标签，在页面中挂载调用接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> scriptTag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;script&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scriptTag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">src </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">appendChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scriptTag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//返回Promise方便链式调用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">window</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">jsonp</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">rest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">removeChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scriptTag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//调用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">jsonp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requestData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当然上述只是简单的 JSONP 实现，在实际的使用中 JSONP 还存在诸多问题：</p>
<p><strong>1. CSRF 攻击</strong><br>
<!-- -->当前端发起一个伪造的恶意 JSONP 请求时，服务端的敏感信息，如用户的个人信息，密码等存在泄露的风险，需要通过验证 JSONP 的调用来源（Referer），服务端判断  Referer  是否是白名单，或者部署随机  Token  来防御攻击</p>
<p><strong>2. XSS 漏洞</strong><br>
<!-- -->不严谨的  content-type 类型会导致的  XSS  漏洞，如果没有严格定义好  Content-Type，例如 Content-Type: application/json，或者对请求 url 的 query 参数没有进行过滤，导致请求参数是一段恶意 JavaScript 代码，并被服务端接收执行并返回，那么前端就会执行这段恶意代码
通过严格定义 Content-Type: application/json，然后严格过滤 callback 后的参数并且限制长度（进行字符转义，例如<code>&lt;换成&amp;lt</code>，<code>&gt;换成&amp;gt</code>）等，这样返回的脚本内容会变成文本格式，脚本将不会执行</p>
<p><strong>3. 仅支持 GET 请求方式</strong><br>
<!-- -->JSOP 仅支持 GET 方式的请求，对于 POST 等其他请求方式并不能使用 JSONP</p>
<p>参考文献<br>
<a href="https://juejin.cn/post/7285576848237412387" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7285576848237412387</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2cors跨域资源共享">2.CORS(跨域资源共享)<a href="#2cors 跨域资源共享" class="hash-link" aria-label="Direct link to 2.CORS(跨域资源共享)" title="Direct link to 2.CORS(跨域资源共享)">​</a></h3>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="228" height="289" class="img_ev3q"></p>
<p>如上述图所示，，跨域发生的原因就是在这个校验规则上，校验通过了就不会发生跨域问题，校验不通过就会引发跨域问题，跨域的校验规则就是 CORS 规则，也是跨域产生的最本质的地方</p>
<p>跨域的解决方法有很多种，但是 CORS 一定是最根本、最正统的方法</p>
<p>CORS 是一套机制，用于浏览器校验跨域请求</p>
<p>它的基本理念是：</p>
<p>只要服务器明确表示允许，则校验通过</p>
<p>服务器明确拒绝或没有表示，则校验不通过</p>
<p>所以这里的解决主要靠服务器，还得保证服务器是自己人，能访问修改</p>
<p>CORS 将请求分为两类：简单请求和预检请求</p>
<p><strong>简单请求</strong></p>
<ul>
<li>请求方法为：GET、HEAD、POST</li>
<li>头部字段满足 CORS 安全规范，详见：MDN</li>
<li>请求头的 Content-Type 为：<!-- -->
<ol>
<li>text/plain(表示请求体中是纯文本数据，可以用普通的纯文本编辑器查看与编辑)</li>
<li>multipart/form-data(表示请求体中包含多种数据类型，如文件上传等，通常用于表单提交)</li>
<li>application/x-www-form-urlencoded(表示请求体中包含键值对数据，以键值对的形式拼接在 URL 后面发送请求，也可放在请求体中)</li>
</ol>
</li>
</ul>
<p>这里注意只要不去改动请求头部字段，则基本都是满足安全规范</p>
<p><strong>预检请求</strong>
即是非简单请求</p>
<p>举两个例子：</p>
<p><code>fetch(&#x27;https://douyin.com&#x27;)</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross16-47bf8ec1f5ddc9709238a05bb8df5d54.png" width="808" height="440" class="img_ev3q"></p>
<p>这是个简单请求</p>
<p><code>fetch(&#x27;https://douyin.com&#x27;, {headers:{a:1}})</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross17-e2df260ef1ffe99354a3c955b0a4a44d.png" width="1038" height="683" class="img_ev3q"></p>
<p>这是预检请求，因为改了头部字段</p>
<p>知道了简单请求和预检请求后，那么浏览器遇到这两种请求是如何校验的呢？</p>
<p><strong>针对简单请求和预检请求的校验</strong></p>
<p>简单请求：</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="364" height="299" class="img_ev3q"></p>
<p>这里浏览器发现是简单请求后，会自动在请求头 headers 中添加 Origin 这个字段，表示是来自哪个源的请求，然后服务器一般会在返回响应头中添加 Access-Control-Allow-Origin 字段，如果值和请求源一样，浏览器一看表示允许这个源通过，则校验通过；或者值为*号，表示所有源都可以通过，那浏览器一看不管了，都校验通过</p>
<p>预检请求：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross19-7f03153cff59c671923b3a8be0d2244b.png" width="396" height="307" class="img_ev3q"></p>
<p>当浏览器发现是预检请求后，会先发出一个 OPTIONS 的预检请求，请求头中带有 Origin-请求源地址，Access-Control-Request-Method-请求方法和 Access-Control-Request-Headers-这次请求改动的头部字段等，服务器收到后会返回响应头字段有允许的源地址、允许的方法、允许的头部 headers 和最大缓存时间，下次这个时间范围内直接使用缓存</p>
<p>当这个 OPTIONS 请求通过后才会发出真实的请求和简单请求处理一模一样</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3proxy-反向代理">3.proxy 反向代理<a href="#3proxy-反向代理" class="hash-link" aria-label="Direct link to 3.proxy 反向代理" title="Direct link to 3.proxy 反向代理">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="运用-devserverproxy-进行请求代理">运用 devServer.proxy 进行请求代理<a href="#运用-devserverproxy-进行请求代理" class="hash-link" aria-label="Direct link to 运用 devServer.proxy 进行请求代理" title="Direct link to 运用 devServer.proxy 进行请求代理">​</a></h4>
<p>devServer.proxy 是 webpack 开发服务器的一个配置选项，通过该选项配置可以在开发环境中实现跨域请求的代理。它解决跨域问题的原理是将前端的请求转发到后端，然后由后端再代理发送请求到目标服务器，最终将响应返回给前端。</p>
<p>所以，如果我们的项目是通过 webpack 启动服务的或者框架底层正好使用了 http-proxy-middleware 服务的，都可以通过配置 devServer.proxy 直接解决跨域问题。</p>
<p>核心流程如下：</p>
<ol>
<li><strong>配置 devServer.proxy</strong></li>
</ol>
<p>在 webpack 配置文件中的 devServer 部分，通过设置 proxy 选项配置代理。例如：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exports </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">devServer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">proxy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;/api&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">target</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://localhost:3000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 如果本地使用的后端服务在 localhost:3000 上，可以使用它来启用代理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">changeOrigin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">pathRewrite</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&quot;^/api&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>​ 上述配置表示将以 <code>/api</code> 开头的请求代理到 <code>http://localhost:3000</code>。</p>
<ol start="2">
<li>
<p><strong>启动 webpack 开发  服务器</strong><br>
<!-- -->当开发者启动 webpack 开发服务器时，它会监听前端的请求，并根据 devServer.proxy 的配置将符合条件的请求代理到指定的后端服务器。</p>
</li>
<li>
<p><strong>代理转发</strong><br>
<!-- -->当前端发起以 <code>/api</code> 开头的请求时，webpack 开发服务器将请求转发到指定的后端服务器（例如<code>http://localhost:3000</code>）。</p>
</li>
<li>
<p><strong>后端处理请求</strong><br>
<!-- -->后端服务器接收到代理过来的请求后，按照正常的处理流程处理请求，并将响应返回。</p>
</li>
<li>
<p><strong>前端接收响应</strong><br>
<!-- -->最终，webpack 开发服务器将后端服务器的响应返回给前端，完成整个代理过程。</p>
</li>
</ol>
<p>通过使用 devServer.proxy 配置，前端在开发环境中能够绕过同源策略的限制，实现与后端不同域的服务器进行交互，从而解决跨域问题。这样开发者可以在本地开发环境中方便地与后端服务进行协作和调试。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="http-proxy-middleware-介绍">http-proxy-middleware 介绍：<a href="#http-proxy-middleware-介绍" class="hash-link" aria-label="Direct link to http-proxy-middleware 介绍：" title="Direct link to http-proxy-middleware 介绍：">​</a></h4>
<p>上文所述的 devServer.proxy 代理功能，其底层依赖于 http-proxy-middleware 软件包。所以如果需要设置更多的代理服务配置，可以借鉴参考 http-proxy-middleware 配置文档说明。</p>
<p>http-proxy-middleware 本质上是一个 Node.js 的中间件库，用于在 Express、Koa 或任何基于 Node.js 的 HTTP 服务器上代理 HTTP 请求。</p>
<p>它的工作原理如下：</p>
<ol>
<li>当客户端发起 HTTP 请求时，请求首先被发送到代理服务器。</li>
<li>代理服务器收到请求后，根据配置的规则（如目标地址、路径重写等）修改请求的参数。</li>
<li>修改后的请求被转发到目标服务器。</li>
<li>目标服务器接收到请求后，处理请求并返回响应。</li>
<li>代理服务器接收到响应后，根据配置的规则（如路径重写、请求头修改等）修改响应的参数。</li>
<li>修改后的响应被返回给客户端。</li>
</ol>
<p>http-proxy-middleware 可以方便地配置代理规则，支持按路径、按域名、按请求头等进行匹配和过滤，也可以对请求和响应进行修改。通过这种方式，它可以实现反向代理、请求转发、API 接口代理等功能。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="设置了-proxy-无效">设置了 proxy 无效？<a href="#设置了-proxy-无效" class="hash-link" aria-label="Direct link to 设置了 proxy 无效？" title="Direct link to 设置了 proxy 无效？">​</a></h4>
<p>设置了 <code>proxy</code> 后，发现还是无法生效。此时你需要了解一个问题，你的请求连接符合 <code>proxy</code> 的匹配规则吗？</p>
<p>出现这个问题的大概率是你的项目代码设置了请求的域名，比如你的接口地址是 <code>a.com</code>，你的前端项目是 <code>localhost:8080</code>,前端设置了 <code>baseUrl=&#x27;a.com&#x27;</code>，此时浏览器发出的请求路径是 <code>a.com/api/xxx</code>，这个路径是浏览器直接向 <code>a.com</code> 域名发出的请求，根本没有走项目本地配置的 <code>proxy</code>，所以才不会生效。</p>
<p>解决办法：把 <code>baseUrl</code> 设置删除（通过 <code>proxy</code> 匹配你的<code>/api/xxx</code> 路径代理请求，而不是代码直接写目标域名的地址）</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4nginx-代理">4.Nginx 代理<a href="#4nginx-代理" class="hash-link" aria-label="Direct link to 4.Nginx 代理" title="Direct link to 4.Nginx 代理">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/cross1-ed5833c7e4f94171d2fe3265ccb3ac14.png" width="649" height="382" class="img_ev3q"></p>
<p>Nginx 配置解决浏览器跨域问题的原理是通过反向代理，将前端应用和后端服务整合在同一域名和端口下。通过在 Nginx 配置文件中设置不同路径的 location 块，将前端请求和后端请求分别代理到对应的服务地址，确保它们具有相同的域名和端口。这样一来，前端页面和后端服务在同一源上，遵循浏览器的同源策略，解决了跨域问题。</p>
<p>在代理过程中，Nginx 还可以添加自定义的请求头信息，确保正确的信息传递和安全性。通过这种方式，Nginx 提供了一种简便有效的解决跨域问题的方法，同时提高了应用的灵活性和安全性。</p>
<p>例如：当前端应用页面部署于 <code>http://10.188.27.166:9897</code>，后端服务接口部署于 <code>http://10.188.27.166:9898</code>，因为两者的端口不一致，所以就会导致跨域请求限制。我们可以通过 nginx.conf 配置，让两者处于同一个域名和端口下，配置如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen       8080; # 端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name  localhost; # 域名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">				# 代理所有前端页面</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            proxy_pass http://10.188.27.166:9897;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">				# 代理后端接口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location /cors-api {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            proxy_pass http://10.188.27.166:9898;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">						# 添加了部分自定义属性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            add_header Access-Control-Allow-Origin * always;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            add_header Access-Control-Allow-Headers *;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            add_header Access-Control-Allow-Methods &quot;GET, POST, PUT, OPTIONS&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if ($request_method = &#x27;OPTIONS&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return 200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>执行 nginx -s reload 命令重新启动 nginx 服务后，我们在浏览器访问 <a href="http://localhost:8080/" target="_blank" rel="noopener noreferrer">http://localhost:8080/</a> 地址，跨域限制问题就已经被成功解决了.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5关闭浏览器同源策略">5.关闭浏览器同源策略<a href="#5关闭浏览器同源策略" class="hash-link" aria-label="Direct link to 5.关闭浏览器同源策略" title="Direct link to 5.关闭浏览器同源策略">​</a></h3>
<p>在启动 Chrome 浏览器时，添加 --disable-web-security 参数可用来禁用同源策略。但请注意，这种方式只是在开发和调试时使用，不要在生产环境中禁用同源策略来验收项目。具体操作如下：</p>
<p><code>Mac</code> 电脑，直接在终端命令行中输入如下指令（<code>&lt;自定义目录&gt;</code> 例如：<code>/Users/xxx/MyChromeData</code>） ：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ open -n /Applications/Google\ Chrome.app/ --args --disable-web-security --user-data-dir=&lt;自定 义目录&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>Windows 电脑，右键点击 Chrome 浏览器 -&gt; 属性 -&gt; 目标 -&gt; 在 chrome.exe 路径后面添加代码 --disable-web-security --user-data-dir=&quot;&lt;自定义目录&gt;&quot;。(&lt;自定义目录&gt; 例如：D:\MyChromeData)</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross2-288ebddb76b9d8def5983b57b2c19466.png" width="681" height="958" class="img_ev3q"></p>
<p>后续打开该 Chrome 浏览器应用，都是以禁用浏览器同源策略的方式打开。如果设置成功了，打开 Chrome 浏览器会有如下提示：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross3-fc9d6aaa95dbcd6c908f3384229cec2b.png" width="1575" height="990" class="img_ev3q"></p>
<p>既然导致跨域的“罪魁祸首”是浏览器的同源策略，我们直接从根本入手不就解决问题了吗？</p>
<p>各大主流浏览器也确实提供了关闭同源策略的功能</p>
<p>IE 浏览器：进入 ie 的网际网路选项设置，然后选择安全性，再选择自订等级，然后下拉，找到「存取跨网络的资料来源」，选择启用即可</p>
<p>chrome 浏览器：首先需要关闭所有打开的浏览器窗口，在命令行窗口输入 chrome --disable-web-security</p>
<p>FireFox 浏览器：在地址栏输入 about<!-- -->:config<!-- -->，然后下拉找到 security.fileuri.strict_origin_policy，然后设置  为 false 即可</p>
<p>这样的做法确实从根本上解决了跨域问题，但禁用同源策略会导致安全风险，所有并不推荐这样做</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="六其它方法">六、其它方法<a href="#六其它方法" class="hash-link" aria-label="Direct link to 六、其它方法" title="Direct link to 六、其它方法">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="借助浏览器插件的妙用">借助浏览器插件的妙用<a href="#借助浏览器插件的妙用" class="hash-link" aria-label="Direct link to 借助浏览器插件的妙用" title="Direct link to 借助浏览器插件的妙用">​</a></h3>
<p>一些浏览器插件允许在浏览器中启用 CORS 配置，以便在开发过程中更轻松地处理跨域请求，也有一些插件可以帮助临时禁用或修改浏览器的安全设置，以允许跨域请求。以下是一些常见的浏览器插件：</p>
<ol>
<li>CORS Unblock: 解除跨域限制。</li>
<li>Allow-Control-Allow-Origin: 允许跨域资源共享（CORS）。</li>
<li>ModHeader: 允许用户修改请求头，可以用于测试不同的 CORS 配置。</li>
<li>Postman Interceptor: 结合 Postman 工具使用，拦截请求和响应，方便测试和调试。</li>
</ol>
<p>请注意，使用这些插件时应谨慎，仅在开发和调试环境中使用，切勿在生产环境中禁用浏览器的安全设置。</p>
<p>下面将简单介绍一下 Chrome 插件 CORS Unblock 的使用。</p>
<p>步骤一：在 chrome 应用商店 搜索 CORS Unblock 插件，并点击安装。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross4-edaf99d5e3b1b4a4e0793fb47df03e44.png" width="1750" height="732" class="img_ev3q"></p>
<p>步骤二：固定插件到导航栏，并点击启用 CORS Unblock 插件。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="386" height="237" class="img_ev3q"></p>
<p>步骤三：刷新网页，会发现原本存在跨域限制的接口都可以正常访问了。</p>
<p>启动插件前：跨域请求失败</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross6-d93c81f2922b742016dedbb6db03a384.png" width="997" height="363" class="img_ev3q"></p>
<p>启动插件后：跨域请求被自动添加了 CORS 配置，请求成功</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross7-614b26e60768b5a831f2645d55438b58.png" width="994" height="518" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="巧用抓包工具代理请求">巧用抓包工具代理请求<a href="#巧用抓包工具代理请求" class="hash-link" aria-label="Direct link to 巧用抓包工具代理请求" title="Direct link to 巧用抓包工具代理请求">​</a></h3>
<p>抓包工具是一类用于捕获、分析和修改计算机网络通信流量的软件工具。这些工具允许开发人员和网络管理员监控应用程序的网络交互，查看请求和响应的详细信息，进行性能评估，以及在开发和测试阶段修改数据流以进行调试。抓包工具对于诊断网络问题、优化性能和确保安全性都具有重要作用。常用的抓包工具有 Fiddler、Charles、Wireshark 等。</p>
<p>使用抓包工具代理请求的方式来处理跨域问题，通常涉及将 Web 网络请求通过工具进行中间代理，实现对请求和响应的监控、分析和修改。通过抓包工具的 rewrite 能力重写网络响应，给存在跨域的接口都添加上 CORS 相关配置，来解决跨域问题。</p>
<p>下面将简单介绍 Charles 工具的操作步骤：</p>
<p>步骤一：打开 Charles 工具栏 Tools --&gt; Rewrite</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross8-7f9f8a3ad4929141392b2efd9136af74.png" width="1154" height="360" class="img_ev3q"></p>
<p>步骤二：添加 Rewrite 配置</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross9-3945cc0d7ccf40124874e9c8458f1714.png" width="931" height="705" class="img_ev3q"></p>
<p>步骤三：Add 时添加 CORS 配置响应头</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross10-b06ad8457b889564a70931dea6cb0890.png" width="818" height="738" class="img_ev3q"></p>
<p>通过完成上述的三个步骤，我们现在就可以直接访问跨域接口了，可以看到所有的接口响应上都已经被添加了 <code>Access-Control-Allow-Origin:\*</code> CORS 属性。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/cross11-bb1e91d09a4c9503f37317a308958c4e.png" width="723" height="239" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="csrf-攻击">CSRF 攻击<a href="#csrf-攻击" class="hash-link" aria-label="Direct link to CSRF 攻击" title="Direct link to CSRF 攻击">​</a></h2>
<p>CSRF，又称跨站请求伪造，指非法网站挟持用户 cookie 在已登陆网站上实施非法操作的攻击，这是基于使用 cookie 在网站免登和用户信息留存的实用性，接下来来讲讲正常网站免登的请求流程。</p>
<p>请求流程如下:</p>
<blockquote>
<p>我们进入一个网站，发送登陆请求给后端<br>
<!-- -->后端接受登陆请求，判断登陆信息是否准确<br>
<!-- -->判断信息准确后后端后会发送 response 给浏览器并在 response header 中加入 set-cookie 字段<br>
<!-- -->浏览器接受 response 返给用户，并将 header 中的 cookie 进行保存<br>
<!-- -->用户关闭当前网站窗口后再次打开后，浏览器会自动将 cookie 加入 request header 实现免登</p>
</blockquote>
<p>我们设想这样一个场景</p>
<blockquote>
<p>小 a 登陆了网银网站，小 a 所在浏览器记录了网银回馈的 cookie<br>
<!-- -->这时他 qq 上收到个链接，什么澳门赌场，美女荷官，在线送钱的网站 b<br>
<!-- -->他点开那个链接之后，网站 b 就可以携带浏览器设置的 cookie 向网银系统上发送请求</p>
</blockquote></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/浏览器/浏览器缓存机制"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">浏览器缓存机制</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/浏览器/跨域形成原因以及解决方案"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">跨域形成原因以及解决方案</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一跨域的原因" class="table-of-contents__link toc-highlight">一、跨域的原因</a><ul><li><a href="#同源策略" class="table-of-contents__link toc-highlight">同源策略</a></li><li><a href="#哪些情况下产生跨域" class="table-of-contents__link toc-highlight">哪些情况下产生跨域</a></li><li><a href="#何为同源请求" class="table-of-contents__link toc-highlight">何为同源请求？</a></li><li><a href="#浏览器如何限制" class="table-of-contents__link toc-highlight">浏览器如何限制？</a></li></ul></li><li><a href="#二跨越解决方式" class="table-of-contents__link toc-highlight">二、跨越解决方式</a><ul><li><a href="#1jsonp" class="table-of-contents__link toc-highlight">1.jsonp</a></li><li><a href="#2cors跨域资源共享" class="table-of-contents__link toc-highlight">2.CORS(跨域资源共享)</a></li><li><a href="#3proxy-反向代理" class="table-of-contents__link toc-highlight">3.proxy 反向代理</a></li><li><a href="#4nginx-代理" class="table-of-contents__link toc-highlight">4.Nginx 代理</a></li><li><a href="#5关闭浏览器同源策略" class="table-of-contents__link toc-highlight">5.关闭浏览器同源策略</a></li></ul></li><li><a href="#六其它方法" class="table-of-contents__link toc-highlight">六、其它方法</a><ul><li><a href="#借助浏览器插件的妙用" class="table-of-contents__link toc-highlight">借助浏览器插件的妙用</a></li><li><a href="#巧用抓包工具代理请求" class="table-of-contents__link toc-highlight">巧用抓包工具代理请求</a></li></ul></li><li><a href="#csrf-攻击" class="table-of-contents__link toc-highlight">CSRF 攻击</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>