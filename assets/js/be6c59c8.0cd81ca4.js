"use strict";(self.webpackChunkfn_wang_10_github_io=self.webpackChunkfn_wang_10_github_io||[]).push([[29870],{10316:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>d,toc:()=>l});var t=r(74848),o=r(28453);const s={},i=void 0,d={id:"Vue/Vue\u5b9e\u4f8b\u6302\u8f7d\u7684\u8fc7\u7a0b",title:"Vue\u5b9e\u4f8b\u6302\u8f7d\u7684\u8fc7\u7a0b",description:"\u4e00\u3001\u601d\u8003",source:"@site/docs/Vue/Vue\u5b9e\u4f8b\u6302\u8f7d\u7684\u8fc7\u7a0b.md",sourceDirName:"Vue",slug:"/Vue/Vue\u5b9e\u4f8b\u6302\u8f7d\u7684\u8fc7\u7a0b",permalink:"/docs/Vue/Vue\u5b9e\u4f8b\u6302\u8f7d\u7684\u8fc7\u7a0b",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"vueSidebar",previous:{title:"Vue.observable\u4f60\u6709\u4e86\u89e3\u8fc7\u5417\uff1f",permalink:"/docs/Vue/Vue.observable\u4f60\u6709\u4e86\u89e3\u8fc7\u5417\uff1f"},next:{title:"Vue\u9879\u76ee\u4e2d\u4f60\u662f\u5982\u4f55\u89e3\u51b3\u8de8\u57df\u7684\u5462\uff1f",permalink:"/docs/Vue/Vue\u9879\u76ee\u4e2d\u4f60\u662f\u5982\u4f55\u89e3\u51b3\u8de8\u57df\u7684\u5462\uff1f"}},c={},l=[{value:"\u4e00\u3001\u601d\u8003",id:"\u4e00\u601d\u8003",level:2},{value:"\u4e00\u3001\u5206\u6790",id:"\u4e00\u5206\u6790",level:2},{value:"\u4e09\u3001\u7ed3\u8bba",id:"\u4e09\u7ed3\u8bba",level:2},{value:"\u53c2\u8003\u6587\u732e",id:"\u53c2\u8003\u6587\u732e",level:2}];function a(n){const e={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"\u4e00\u601d\u8003",children:"\u4e00\u3001\u601d\u8003"}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u4eec\u90fd\u542c\u8fc7\u77e5\u5176\u7136\u77e5\u5176\u6240\u4ee5\u7136\u8fd9\u53e5\u8bdd"}),"\n",(0,t.jsxs)(e.p,{children:["\u90a3\u4e48\u4e0d\u77e5\u9053\u5927\u5bb6\u662f\u5426\u601d\u8003\u8fc7",(0,t.jsx)(e.code,{children:"new Vue()"}),"\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u7a76\u7adf\u505a\u4e86\u4e9b\u4ec0\u4e48\uff1f"]}),"\n",(0,t.jsx)(e.p,{children:"\u8fc7\u7a0b\u4e2d\u662f\u5982\u4f55\u5b8c\u6210\u6570\u636e\u7684\u7ed1\u5b9a\uff0c\u53c8\u662f\u5982\u4f55\u5c06\u6570\u636e\u6e32\u67d3\u5230\u89c6\u56fe\u7684\u7b49\u7b49"}),"\n",(0,t.jsx)(e.h2,{id:"\u4e00\u5206\u6790",children:"\u4e00\u3001\u5206\u6790"}),"\n",(0,t.jsxs)(e.p,{children:["\u9996\u5148\u627e\u5230",(0,t.jsx)(e.code,{children:"vue"}),"\u7684\u6784\u9020\u51fd\u6570"]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1asrc\\core\\instance\\index.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'function Vue(options) {\r\n  if (process.env.NODE_ENV !== "production" && !(this instanceof Vue)) {\r\n    warn("Vue is a constructor and should be called with the `new` keyword");\r\n  }\r\n  this._init(options);\r\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"options"}),"\u662f\u7528\u6237\u4f20\u9012\u8fc7\u6765\u7684\u914d\u7f6e\u9879\uff0c\u5982",(0,t.jsx)(e.code,{children:"data\u3001methods"}),"\u7b49\u5e38\u7528\u7684\u65b9\u6cd5"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"vue"}),"\u6784\u5efa\u51fd\u6570\u8c03\u7528",(0,t.jsx)(e.code,{children:"_init"}),"\u65b9\u6cd5\uff0c\u4f46\u6211\u4eec\u53d1\u73b0\u672c\u6587\u4ef6\u4e2d\u5e76\u6ca1\u6709\u6b64\u65b9\u6cd5\uff0c\u4f46\u4ed4\u7ec6\u53ef\u4ee5\u770b\u5230\u6587\u4ef6\u4e0b\u65b9\u5b9a\u5b9a\u4e49\u4e86\u5f88\u591a\u521d\u59cb\u5316\u65b9\u6cd5"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"initMixin(Vue); // \u5b9a\u4e49 _init\r\nstateMixin(Vue); // \u5b9a\u4e49 $set $get $delete $watch \u7b49\r\neventsMixin(Vue); // \u5b9a\u4e49\u4e8b\u4ef6  $on  $once $off $emit\r\nlifecycleMixin(Vue); // \u5b9a\u4e49 _update  $forceUpdate  $destroy\r\nrenderMixin(Vue); // \u5b9a\u4e49 _render \u8fd4\u56de\u865a\u62dfdom\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u9996\u5148\u53ef\u4ee5\u770b",(0,t.jsx)(e.code,{children:"initMixin"}),"\u65b9\u6cd5\uff0c\u53d1\u73b0\u8be5\u65b9\u6cd5\u5728",(0,t.jsx)(e.code,{children:"Vue"}),"\u539f\u578b\u4e0a\u5b9a\u4e49\u4e86",(0,t.jsx)(e.code,{children:"_init"}),"\u65b9\u6cd5"]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1asrc\\core\\instance\\init.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'Vue.prototype._init = function (options?: Object) {\r\n  const vm: Component = this;\r\n  // a uid\r\n  vm._uid = uid++;\r\n  let startTag, endTag;\r\n  /* istanbul ignore if */\r\n  if (process.env.NODE_ENV !== "production" && config.performance && mark) {\r\n    startTag = `vue-perf-start:${vm._uid}`;\r\n    endTag = `vue-perf-end:${vm._uid}`;\r\n    mark(startTag);\r\n  }\r\n\r\n  // a flag to avoid this being observed\r\n  vm._isVue = true;\r\n  // merge options\r\n  // \u5408\u5e76\u5c5e\u6027\uff0c\u5224\u65ad\u521d\u59cb\u5316\u7684\u662f\u5426\u662f\u7ec4\u4ef6\uff0c\u8fd9\u91cc\u5408\u5e76\u4e3b\u8981\u662f mixins \u6216 extends \u7684\u65b9\u6cd5\r\n  if (options && options._isComponent) {\r\n    // optimize internal component instantiation\r\n    // since dynamic options merging is pretty slow, and none of the\r\n    // internal component options needs special treatment.\r\n    initInternalComponent(vm, options);\r\n  } else {\r\n    // \u5408\u5e76vue\u5c5e\u6027\r\n    vm.$options = mergeOptions(\r\n      resolveConstructorOptions(vm.constructor),\r\n      options || {},\r\n      vm\r\n    );\r\n  }\r\n  /* istanbul ignore else */\r\n  if (process.env.NODE_ENV !== "production") {\r\n    // \u521d\u59cb\u5316proxy\u62e6\u622a\u5668\r\n    initProxy(vm);\r\n  } else {\r\n    vm._renderProxy = vm;\r\n  }\r\n  // expose real self\r\n  vm._self = vm;\r\n  // \u521d\u59cb\u5316\u7ec4\u4ef6\u751f\u547d\u5468\u671f\u6807\u5fd7\u4f4d\r\n  initLifecycle(vm);\r\n  // \u521d\u59cb\u5316\u7ec4\u4ef6\u4e8b\u4ef6\u4fa6\u542c\r\n  initEvents(vm);\r\n  // \u521d\u59cb\u5316\u6e32\u67d3\u65b9\u6cd5\r\n  initRender(vm);\r\n  callHook(vm, "beforeCreate");\r\n  // \u521d\u59cb\u5316\u4f9d\u8d56\u6ce8\u5165\u5185\u5bb9\uff0c\u5728\u521d\u59cb\u5316data\u3001props\u4e4b\u524d\r\n  initInjections(vm); // resolve injections before data/props\r\n  // \u521d\u59cb\u5316props/data/method/watch/methods\r\n  initState(vm);\r\n  initProvide(vm); // resolve provide after data/props\r\n  callHook(vm, "created");\r\n\r\n  /* istanbul ignore if */\r\n  if (process.env.NODE_ENV !== "production" && config.performance && mark) {\r\n    vm._name = formatComponentName(vm, false);\r\n    mark(endTag);\r\n    measure(`vue ${vm._name} init`, startTag, endTag);\r\n  }\r\n  // \u6302\u8f7d\u5143\u7d20\r\n  if (vm.$options.el) {\r\n    vm.$mount(vm.$options.el);\r\n  }\r\n};\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4ed4\u7ec6\u9605\u8bfb\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u5f97\u5230\u4ee5\u4e0b\u7ed3\u8bba\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5728\u8c03\u7528",(0,t.jsx)(e.code,{children:"beforeCreate"}),"\u4e4b\u524d\uff0c\u6570\u636e\u521d\u59cb\u5316\u5e76\u672a\u5b8c\u6210\uff0c\u50cf",(0,t.jsx)(e.code,{children:"data"}),"\u3001",(0,t.jsx)(e.code,{children:"props"}),"\u8fd9\u4e9b\u5c5e\u6027\u65e0\u6cd5\u8bbf\u95ee\u5230"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5230\u4e86",(0,t.jsx)(e.code,{children:"created"}),"\u7684\u65f6\u5019\uff0c\u6570\u636e\u5df2\u7ecf\u521d\u59cb\u5316\u5b8c\u6210\uff0c\u80fd\u591f\u8bbf\u95ee",(0,t.jsx)(e.code,{children:"data"}),"\u3001",(0,t.jsx)(e.code,{children:"props"}),"\u8fd9\u4e9b\u5c5e\u6027\uff0c\u4f46\u8fd9\u65f6\u5019\u5e76\u672a\u5b8c\u6210",(0,t.jsx)(e.code,{children:"dom"}),"\u7684\u6302\u8f7d\uff0c\u56e0\u6b64\u65e0\u6cd5\u8bbf\u95ee\u5230",(0,t.jsx)(e.code,{children:"dom"}),"\u5143\u7d20"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u6302\u8f7d\u65b9\u6cd5\u662f\u8c03\u7528",(0,t.jsx)(e.code,{children:"vm.$mount"}),"\u65b9\u6cd5"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"initState"}),"\u65b9\u6cd5\u662f\u5b8c\u6210",(0,t.jsx)(e.code,{children:"props/data/method/watch/methods"}),"\u7684\u521d\u59cb\u5316"]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1asrc\\core\\instance\\state.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"export function initState(vm: Component) {\r\n  // \u521d\u59cb\u5316\u7ec4\u4ef6\u7684watcher\u5217\u8868\r\n  vm._watchers = [];\r\n  const opts = vm.$options;\r\n  // \u521d\u59cb\u5316props\r\n  if (opts.props) initProps(vm, opts.props);\r\n  // \u521d\u59cb\u5316methods\u65b9\u6cd5\r\n  if (opts.methods) initMethods(vm, opts.methods);\r\n  if (opts.data) {\r\n    // \u521d\u59cb\u5316data\r\n    initData(vm);\r\n  } else {\r\n    observe((vm._data = {}), true /* asRootData */);\r\n  }\r\n  if (opts.computed) initComputed(vm, opts.computed);\r\n  if (opts.watch && opts.watch !== nativeWatch) {\r\n    initWatch(vm, opts.watch);\r\n  }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u6211\u4eec\u548c\u8fd9\u91cc\u4e3b\u8981\u770b\u521d\u59cb\u5316",(0,t.jsx)(e.code,{children:"data"}),"\u7684\u65b9\u6cd5\u4e3a",(0,t.jsx)(e.code,{children:"initData"}),"\uff0c\u5b83\u4e0e",(0,t.jsx)(e.code,{children:"initState"}),"\u5728\u540c\u4e00\u6587\u4ef6\u4e0a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'function initData(vm: Component) {\r\n  let data = vm.$options.data;\r\n  // \u83b7\u53d6\u5230\u7ec4\u4ef6\u4e0a\u7684data\r\n  data = vm._data = typeof data === "function" ? getData(data, vm) : data || {};\r\n  if (!isPlainObject(data)) {\r\n    data = {};\r\n    process.env.NODE_ENV !== "production" &&\r\n      warn(\r\n        "data functions should return an object:\\n" +\r\n          "https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function",\r\n        vm\r\n      );\r\n  }\r\n  // proxy data on instance\r\n  const keys = Object.keys(data);\r\n  const props = vm.$options.props;\r\n  const methods = vm.$options.methods;\r\n  let i = keys.length;\r\n  while (i--) {\r\n    const key = keys[i];\r\n    if (process.env.NODE_ENV !== "production") {\r\n      // \u5c5e\u6027\u540d\u4e0d\u80fd\u4e0e\u65b9\u6cd5\u540d\u91cd\u590d\r\n      if (methods && hasOwn(methods, key)) {\r\n        warn(\r\n          `Method "${key}" has already been defined as a data property.`,\r\n          vm\r\n        );\r\n      }\r\n    }\r\n    // \u5c5e\u6027\u540d\u4e0d\u80fd\u4e0estate\u540d\u79f0\u91cd\u590d\r\n    if (props && hasOwn(props, key)) {\r\n      process.env.NODE_ENV !== "production" &&\r\n        warn(\r\n          `The data property "${key}" is already declared as a prop. ` +\r\n            `Use prop default value instead.`,\r\n          vm\r\n        );\r\n    } else if (!isReserved(key)) {\r\n      // \u9a8c\u8bc1key\u503c\u7684\u5408\u6cd5\u6027\r\n      // \u5c06_data\u4e2d\u7684\u6570\u636e\u6302\u8f7d\u5230\u7ec4\u4ef6vm\u4e0a,\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7this.xxx\u8bbf\u95ee\u5230\u7ec4\u4ef6\u4e0a\u7684\u6570\u636e\r\n      proxy(vm, `_data`, key);\r\n    }\r\n  }\r\n  // observe data\r\n  // \u54cd\u5e94\u5f0f\u76d1\u542cdata\u662f\u6570\u636e\u7684\u53d8\u5316\r\n  observe(data, true /* asRootData */);\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4ed4\u7ec6\u9605\u8bfb\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u7ed3\u8bba\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u521d\u59cb\u5316\u987a\u5e8f\uff1a",(0,t.jsx)(e.code,{children:"props"}),"\u3001",(0,t.jsx)(e.code,{children:"methods"}),"\u3001",(0,t.jsx)(e.code,{children:"data"})]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"data"}),"\u5b9a\u4e49\u7684\u65f6\u5019\u53ef\u9009\u62e9\u51fd\u6570\u5f62\u5f0f\u6216\u8005\u5bf9\u8c61\u5f62\u5f0f\uff08\u7ec4\u4ef6\u53ea\u80fd\u4e3a\u51fd\u6570\u5f62\u5f0f\uff09"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u5173\u4e8e\u6570\u636e\u54cd\u5e94\u5f0f\u5728\u8fd9\u5c31\u4e0d\u5c55\u5f00\u8be6\u7ec6\u8bf4\u660e"}),"\n",(0,t.jsxs)(e.p,{children:["\u4e0a\u6587\u63d0\u5230\u6302\u8f7d\u65b9\u6cd5\u662f\u8c03\u7528",(0,t.jsx)(e.code,{children:"vm.$mount"}),"\u65b9\u6cd5"]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'Vue.prototype.$mount = function (\r\n  el?: string | Element,\r\n  hydrating?: boolean\r\n): Component {\r\n  // \u83b7\u53d6\u6216\u67e5\u8be2\u5143\u7d20\r\n  el = el && query(el);\r\n\r\n  /* istanbul ignore if */\r\n  // vue \u4e0d\u5141\u8bb8\u76f4\u63a5\u6302\u8f7d\u5230body\u6216\u9875\u9762\u6587\u6863\u4e0a\r\n  if (el === document.body || el === document.documentElement) {\r\n    process.env.NODE_ENV !== "production" &&\r\n      warn(\r\n        `Do not mount Vue to <html> or <body> - mount to normal elements instead.`\r\n      );\r\n    return this;\r\n  }\r\n\r\n  const options = this.$options;\r\n  // resolve template/el and convert to render function\r\n  if (!options.render) {\r\n    let template = options.template;\r\n    // \u5b58\u5728template\u6a21\u677f\uff0c\u89e3\u6790vue\u6a21\u677f\u6587\u4ef6\r\n    if (template) {\r\n      if (typeof template === "string") {\r\n        if (template.charAt(0) === "#") {\r\n          template = idToTemplate(template);\r\n          /* istanbul ignore if */\r\n          if (process.env.NODE_ENV !== "production" && !template) {\r\n            warn(\r\n              `Template element not found or is empty: ${options.template}`,\r\n              this\r\n            );\r\n          }\r\n        }\r\n      } else if (template.nodeType) {\r\n        template = template.innerHTML;\r\n      } else {\r\n        if (process.env.NODE_ENV !== "production") {\r\n          warn("invalid template option:" + template, this);\r\n        }\r\n        return this;\r\n      }\r\n    } else if (el) {\r\n      // \u901a\u8fc7\u9009\u62e9\u5668\u83b7\u53d6\u5143\u7d20\u5185\u5bb9\r\n      template = getOuterHTML(el);\r\n    }\r\n    if (template) {\r\n      /* istanbul ignore if */\r\n      if (process.env.NODE_ENV !== "production" && config.performance && mark) {\r\n        mark("compile");\r\n      }\r\n      /**\r\n       *  1.\u5c06temmplate\u89e3\u6790ast tree\r\n       *  2.\u5c06ast tree\u8f6c\u6362\u6210render\u8bed\u6cd5\u5b57\u7b26\u4e32\r\n       *  3.\u751f\u6210render\u65b9\u6cd5\r\n       */\r\n      const { render, staticRenderFns } = compileToFunctions(\r\n        template,\r\n        {\r\n          outputSourceRange: process.env.NODE_ENV !== "production",\r\n          shouldDecodeNewlines,\r\n          shouldDecodeNewlinesForHref,\r\n          delimiters: options.delimiters,\r\n          comments: options.comments,\r\n        },\r\n        this\r\n      );\r\n      options.render = render;\r\n      options.staticRenderFns = staticRenderFns;\r\n\r\n      /* istanbul ignore if */\r\n      if (process.env.NODE_ENV !== "production" && config.performance && mark) {\r\n        mark("compile end");\r\n        measure(`vue ${this._name} compile`, "compile", "compile end");\r\n      }\r\n    }\r\n  }\r\n  return mount.call(this, el, hydrating);\r\n};\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u9605\u8bfb\u4e0a\u9762\u4ee3\u7801\uff0c\u6211\u4eec\u80fd\u5f97\u5230\u4ee5\u4e0b\u7ed3\u8bba\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u4e0d\u8981\u5c06\u6839\u5143\u7d20\u653e\u5230",(0,t.jsx)(e.code,{children:"body"}),"\u6216\u8005",(0,t.jsx)(e.code,{children:"html"}),"\u4e0a"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u53ef\u4ee5\u5728\u5bf9\u8c61\u4e2d\u5b9a\u4e49",(0,t.jsx)(e.code,{children:"template/render"}),"\u6216\u8005\u76f4\u63a5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"template"}),"\u3001",(0,t.jsx)(e.code,{children:"el"}),"\u8868\u793a\u5143\u7d20\u9009\u62e9\u5668"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u6700\u7ec8\u90fd\u4f1a\u89e3\u6790\u6210",(0,t.jsx)(e.code,{children:"render"}),"\u51fd\u6570\uff0c\u8c03\u7528",(0,t.jsx)(e.code,{children:"compileToFunctions"}),"\uff0c\u4f1a\u5c06",(0,t.jsx)(e.code,{children:"template"}),"\u89e3\u6790\u6210",(0,t.jsx)(e.code,{children:"render"}),"\u51fd\u6570"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u5bf9",(0,t.jsx)(e.code,{children:"template"}),"\u7684\u89e3\u6790\u6b65\u9aa4\u5927\u81f4\u5206\u4e3a\u4ee5\u4e0b\u51e0\u6b65\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5c06",(0,t.jsx)(e.code,{children:"html"}),"\u6587\u6863\u7247\u6bb5\u89e3\u6790\u6210",(0,t.jsx)(e.code,{children:"ast"}),"\u63cf\u8ff0\u7b26"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5c06",(0,t.jsx)(e.code,{children:"ast"}),"\u63cf\u8ff0\u7b26\u89e3\u6790\u6210\u5b57\u7b26\u4e32"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u751f\u6210",(0,t.jsx)(e.code,{children:"render"}),"\u51fd\u6570"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u751f\u6210",(0,t.jsx)(e.code,{children:"render"}),"\u51fd\u6570\uff0c\u6302\u8f7d\u5230",(0,t.jsx)(e.code,{children:"vm"}),"\u4e0a\u540e\uff0c\u4f1a\u518d\u6b21\u8c03\u7528",(0,t.jsx)(e.code,{children:"mount"}),"\u65b9\u6cd5"]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1asrc\\platforms\\web\\runtime\\index.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"// public mount method\r\nVue.prototype.$mount = function (\r\n  el?: string | Element,\r\n  hydrating?: boolean\r\n): Component {\r\n  el = el && inBrowser ? query(el) : undefined;\r\n  // \u6e32\u67d3\u7ec4\u4ef6\r\n  return mountComponent(this, el, hydrating);\r\n};\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u8c03\u7528",(0,t.jsx)(e.code,{children:"mountComponent"}),"\u6e32\u67d3\u7ec4\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'export function mountComponent(\r\n  vm: Component,\r\n  el: ?Element,\r\n  hydrating?: boolean\r\n): Component {\r\n  vm.$el = el;\r\n  // \u5982\u679c\u6ca1\u6709\u83b7\u53d6\u89e3\u6790\u7684render\u51fd\u6570\uff0c\u5219\u4f1a\u629b\u51fa\u8b66\u544a\r\n  // render\u662f\u89e3\u6790\u6a21\u677f\u6587\u4ef6\u751f\u6210\u7684\r\n  if (!vm.$options.render) {\r\n    vm.$options.render = createEmptyVNode;\r\n    if (process.env.NODE_ENV !== "production") {\r\n      /* istanbul ignore if */\r\n      if (\r\n        (vm.$options.template && vm.$options.template.charAt(0) !== "#") ||\r\n        vm.$options.el ||\r\n        el\r\n      ) {\r\n        warn(\r\n          "You are using the runtime-only build of Vue where the template " +\r\n            "compiler is not available. Either pre-compile the templates into " +\r\n            "render functions, or use the compiler-included build.",\r\n          vm\r\n        );\r\n      } else {\r\n        // \u6ca1\u6709\u83b7\u53d6\u5230vue\u7684\u6a21\u677f\u6587\u4ef6\r\n        warn(\r\n          "Failed to mount component: template or render function not defined.",\r\n          vm\r\n        );\r\n      }\r\n    }\r\n  }\r\n  // \u6267\u884cbeforeMount\u94a9\u5b50\r\n  callHook(vm, "beforeMount");\r\n\r\n  let updateComponent;\r\n  /* istanbul ignore if */\r\n  if (process.env.NODE_ENV !== "production" && config.performance && mark) {\r\n    updateComponent = () => {\r\n      const name = vm._name;\r\n      const id = vm._uid;\r\n      const startTag = `vue-perf-start:${id}`;\r\n      const endTag = `vue-perf-end:${id}`;\r\n\r\n      mark(startTag);\r\n      const vnode = vm._render();\r\n      mark(endTag);\r\n      measure(`vue ${name} render`, startTag, endTag);\r\n\r\n      mark(startTag);\r\n      vm._update(vnode, hydrating);\r\n      mark(endTag);\r\n      measure(`vue ${name} patch`, startTag, endTag);\r\n    };\r\n  } else {\r\n    // \u5b9a\u4e49\u66f4\u65b0\u51fd\u6570\r\n    updateComponent = () => {\r\n      // \u5b9e\u9645\u8c03\u2f64\u662f\u5728lifeCycleMixin\u4e2d\u5b9a\u4e49\u7684_update\u548crenderMixin\u4e2d\u5b9a\u4e49\u7684_render\r\n      vm._update(vm._render(), hydrating);\r\n    };\r\n  }\r\n  // we set this to vm._watcher inside the watcher\'s constructor\r\n  // since the watcher\'s initial patch may call $forceUpdate (e.g. inside child\r\n  // component\'s mounted hook), which relies on vm._watcher being already defined\r\n  // \u76d1\u542c\u5f53\u524d\u7ec4\u4ef6\u72b6\u6001\uff0c\u5f53\u6709\u6570\u636e\u53d8\u5316\u65f6\uff0c\u66f4\u65b0\u7ec4\u4ef6\r\n  new Watcher(\r\n    vm,\r\n    updateComponent,\r\n    noop,\r\n    {\r\n      before() {\r\n        if (vm._isMounted && !vm._isDestroyed) {\r\n          // \u6570\u636e\u66f4\u65b0\u5f15\u53d1\u7684\u7ec4\u4ef6\u66f4\u65b0\r\n          callHook(vm, "beforeUpdate");\r\n        }\r\n      },\r\n    },\r\n    true /* isRenderWatcher */\r\n  );\r\n  hydrating = false;\r\n\r\n  // manually mounted instance, call mounted on self\r\n  // mounted is called for render-created child components in its inserted hook\r\n  if (vm.$vnode == null) {\r\n    vm._isMounted = true;\r\n    callHook(vm, "mounted");\r\n  }\r\n  return vm;\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u9605\u8bfb\u4e0a\u9762\u4ee3\u7801\uff0c\u6211\u4eec\u5f97\u5230\u4ee5\u4e0b\u7ed3\u8bba\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u4f1a\u89e6\u53d1",(0,t.jsx)(e.code,{children:"beforeCreate"}),"\u94a9\u5b50"]}),"\n",(0,t.jsxs)(e.li,{children:["\u5b9a\u4e49",(0,t.jsx)(e.code,{children:"updateComponent"}),"\u6e32\u67d3\u9875\u9762\u89c6\u56fe\u7684\u65b9\u6cd5"]}),"\n",(0,t.jsxs)(e.li,{children:["\u76d1\u542c\u7ec4\u4ef6\u6570\u636e\uff0c\u4e00\u65e6\u53d1\u751f\u53d8\u5316\uff0c\u89e6\u53d1",(0,t.jsx)(e.code,{children:"beforeUpdate"}),"\u751f\u547d\u94a9\u5b50"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"updateComponent"}),"\u65b9\u6cd5\u4e3b\u8981\u6267\u884c\u5728",(0,t.jsx)(e.code,{children:"vue"}),"\u521d\u59cb\u5316\u65f6\u58f0\u660e\u7684",(0,t.jsx)(e.code,{children:"render"}),"\uff0c",(0,t.jsx)(e.code,{children:"update"}),"\u65b9\u6cd5"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"render"}),"\u7684\u4f5c\u7528\u4e3b\u8981\u662f\u751f\u6210",(0,t.jsx)(e.code,{children:"vnode"})]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1asrc\\core\\instance\\render.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:'// \u5b9a\u4e49vue \u539f\u578b\u4e0a\u7684render\u65b9\u6cd5\r\nVue.prototype._render = function (): VNode {\r\n  const vm: Component = this;\r\n  // render\u51fd\u6570\u6765\u81ea\u4e8e\u7ec4\u4ef6\u7684option\r\n  const { render, _parentVnode } = vm.$options;\r\n\r\n  if (_parentVnode) {\r\n    vm.$scopedSlots = normalizeScopedSlots(\r\n      _parentVnode.data.scopedSlots,\r\n      vm.$slots,\r\n      vm.$scopedSlots\r\n    );\r\n  }\r\n\r\n  // set parent vnode. this allows render functions to have access\r\n  // to the data on the placeholder node.\r\n  vm.$vnode = _parentVnode;\r\n  // render self\r\n  let vnode;\r\n  try {\r\n    // There\'s no need to maintain a stack because all render fns are called\r\n    // separately from one another. Nested component\'s render fns are called\r\n    // when parent component is patched.\r\n    currentRenderingInstance = vm;\r\n    // \u8c03\u7528render\u65b9\u6cd5\uff0c\u81ea\u5df1\u7684\u72ec\u7279\u7684render\u65b9\u6cd5\uff0c \u4f20\u5165createElement\u53c2\u6570\uff0c\u751f\u6210vNode\r\n    vnode = render.call(vm._renderProxy, vm.$createElement);\r\n  } catch (e) {\r\n    handleError(e, vm, `render`);\r\n    // return error render result,\r\n    // or previous vnode to prevent render error causing blank component\r\n    /* istanbul ignore else */\r\n    if (process.env.NODE_ENV !== "production" && vm.$options.renderError) {\r\n      try {\r\n        vnode = vm.$options.renderError.call(\r\n          vm._renderProxy,\r\n          vm.$createElement,\r\n          e\r\n        );\r\n      } catch (e) {\r\n        handleError(e, vm, `renderError`);\r\n        vnode = vm._vnode;\r\n      }\r\n    } else {\r\n      vnode = vm._vnode;\r\n    }\r\n  } finally {\r\n    currentRenderingInstance = null;\r\n  }\r\n  // if the returned array contains only a single node, allow it\r\n  if (Array.isArray(vnode) && vnode.length === 1) {\r\n    vnode = vnode[0];\r\n  }\r\n  // return empty vnode in case the render function errored out\r\n  if (!(vnode instanceof VNode)) {\r\n    if (process.env.NODE_ENV !== "production" && Array.isArray(vnode)) {\r\n      warn(\r\n        "Multiple root nodes returned from render function. Render function " +\r\n          "should return a single root node.",\r\n        vm\r\n      );\r\n    }\r\n    vnode = createEmptyVNode();\r\n  }\r\n  // set parent\r\n  vnode.parent = _parentVnode;\r\n  return vnode;\r\n};\n'})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"_update"}),"\u4e3b\u8981\u529f\u80fd\u662f\u8c03\u7528",(0,t.jsx)(e.code,{children:"patch"}),"\uff0c\u5c06",(0,t.jsx)(e.code,{children:"vnode"}),"\u8f6c\u6362\u4e3a\u771f\u5b9e",(0,t.jsx)(e.code,{children:"DOM"}),"\uff0c\u5e76\u4e14\u66f4\u65b0\u5230\u9875\u9762\u4e2d"]}),"\n",(0,t.jsx)(e.p,{children:"\u6e90\u7801\u4f4d\u7f6e\uff1asrc\\core\\instance\\lifecycle.js"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-js",children:"Vue.prototype._update = function (vnode: VNode, hydrating?: boolean) {\r\n  const vm: Component = this;\r\n  const prevEl = vm.$el;\r\n  const prevVnode = vm._vnode;\r\n  // \u8bbe\u7f6e\u5f53\u524d\u6fc0\u6d3b\u7684\u4f5c\u7528\u57df\r\n  const restoreActiveInstance = setActiveInstance(vm);\r\n  vm._vnode = vnode;\r\n  // Vue.prototype.__patch__ is injected in entry points\r\n  // based on the rendering backend used.\r\n  if (!prevVnode) {\r\n    // initial render\r\n    // \u6267\u884c\u5177\u4f53\u7684\u6302\u8f7d\u903b\u8f91\r\n    vm.$el = vm.__patch__(vm.$el, vnode, hydrating, false /* removeOnly */);\r\n  } else {\r\n    // updates\r\n    vm.$el = vm.__patch__(prevVnode, vnode);\r\n  }\r\n  restoreActiveInstance();\r\n  // update __vue__ reference\r\n  if (prevEl) {\r\n    prevEl.__vue__ = null;\r\n  }\r\n  if (vm.$el) {\r\n    vm.$el.__vue__ = vm;\r\n  }\r\n  // if parent is an HOC, update its $el as well\r\n  if (vm.$vnode && vm.$parent && vm.$vnode === vm.$parent._vnode) {\r\n    vm.$parent.$el = vm.$el;\r\n  }\r\n  // updated hook is called by the scheduler to ensure that children are\r\n  // updated in a parent's updated hook.\r\n};\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u4e09\u7ed3\u8bba",children:"\u4e09\u3001\u7ed3\u8bba"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"new Vue"}),"\u7684\u65f6\u5019\u8c03\u7528\u4f1a\u8c03\u7528",(0,t.jsx)(e.code,{children:"_init"}),"\u65b9\u6cd5"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\u5b9a\u4e49 ",(0,t.jsx)(e.code,{children:"$set"}),"\u3001",(0,t.jsx)(e.code,{children:" $get"})," \u3001",(0,t.jsx)(e.code,{children:"$delete"}),"\u3001",(0,t.jsx)(e.code,{children:"$watch"})," \u7b49\u65b9\u6cd5"]}),"\n",(0,t.jsxs)(e.li,{children:["\u5b9a\u4e49 ",(0,t.jsx)(e.code,{children:"$on"}),"\u3001",(0,t.jsx)(e.code,{children:"$off"}),"\u3001",(0,t.jsx)(e.code,{children:"$emit"}),"\u3001",(0,t.jsx)(e.code,{children:"$off "}),"\u7b49\u4e8b\u4ef6"]}),"\n",(0,t.jsxs)(e.li,{children:["\u5b9a\u4e49 ",(0,t.jsx)(e.code,{children:"_update"}),"\u3001",(0,t.jsx)(e.code,{children:"$forceUpdate"}),"\u3001",(0,t.jsx)(e.code,{children:"$destroy"}),"\u751f\u547d\u5468\u671f"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u8c03\u7528",(0,t.jsx)(e.code,{children:"$mount"}),"\u8fdb\u884c\u9875\u9762\u7684\u6302\u8f7d"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u6302\u8f7d\u7684\u65f6\u5019\u4e3b\u8981\u662f\u901a\u8fc7",(0,t.jsx)(e.code,{children:"mountComponent"}),"\u65b9\u6cd5"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u5b9a\u4e49",(0,t.jsx)(e.code,{children:"updateComponent"}),"\u66f4\u65b0\u51fd\u6570"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:["\u6267\u884c",(0,t.jsx)(e.code,{children:"render"}),"\u751f\u6210\u865a\u62df",(0,t.jsx)(e.code,{children:"DOM"})]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"_update"}),"\u5c06\u865a\u62df",(0,t.jsx)(e.code,{children:"DOM"}),"\u751f\u6210\u771f\u5b9e",(0,t.jsx)(e.code,{children:"DOM"}),"\u7ed3\u6784\uff0c\u5e76\u4e14\u6e32\u67d3\u5230\u9875\u9762\u4e2d"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u53c2\u8003\u6587\u732e",children:"\u53c2\u8003\u6587\u732e"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://www.cnblogs.com/gerry2019/p/12001661.html",children:"https://www.cnblogs.com/gerry2019/p/12001661.html"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://github.com/vuejs/vue/tree/dev/src/core/instance",children:"https://github.com/vuejs/vue/tree/dev/src/core/instance"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://vue3js.cn",children:"https://vue3js.cn"})}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(a,{...n})}):a(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>d});var t=r(96540);const o={},s=t.createContext(o);function i(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);