"use strict";(self.webpackChunkfn_wang_10_github_io=self.webpackChunkfn_wang_10_github_io||[]).push([[14755],{74237:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>l});var s=r(74848),o=r(28453);const t={},c=void 0,i={id:"Vue/\u4f60\u4e86\u89e3axios\u7684\u539f\u7406\u5417\uff1f\u6709\u770b\u8fc7\u5b83\u7684\u6e90\u7801\u5417\uff1f",title:"\u4f60\u4e86\u89e3axios\u7684\u539f\u7406\u5417\uff1f\u6709\u770b\u8fc7\u5b83\u7684\u6e90\u7801\u5417\uff1f",description:"\u4e00\u3001axios \u7684\u4f7f\u7528",source:"@site/docs/Vue/\u4f60\u4e86\u89e3axios\u7684\u539f\u7406\u5417\uff1f\u6709\u770b\u8fc7\u5b83\u7684\u6e90\u7801\u5417\uff1f.md",sourceDirName:"Vue",slug:"/Vue/\u4f60\u4e86\u89e3axios\u7684\u539f\u7406\u5417\uff1f\u6709\u770b\u8fc7\u5b83\u7684\u6e90\u7801\u5417\uff1f",permalink:"/docs/Vue/\u4f60\u4e86\u89e3axios\u7684\u539f\u7406\u5417\uff1f\u6709\u770b\u8fc7\u5b83\u7684\u6e90\u7801\u5417\uff1f",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"vueSidebar",previous:{title:"vue\u9879\u76ee\u672c\u5730\u5f00\u53d1\u5b8c\u6210\u540e\u90e8\u7f72\u5230\u670d\u52a1\u5668\u540e\u62a5404\u662f\u4ec0\u4e48\u539f\u56e0\u5462\uff1f",permalink:"/docs/Vue/vue\u9879\u76ee\u672c\u5730\u5f00\u53d1\u5b8c\u6210\u540e\u90e8\u7f72\u5230\u670d\u52a1\u5668\u540e\u62a5404\u662f\u4ec0\u4e48\u539f\u56e0\u5462\uff1f"},next:{title:"\u4f60\u662f\u600e\u4e48\u5904\u7406vue\u9879\u76ee\u4e2d\u7684\u9519\u8bef\u7684\uff1f",permalink:"/docs/Vue/\u4f60\u662f\u600e\u4e48\u5904\u7406vue\u9879\u76ee\u4e2d\u7684\u9519\u8bef\u7684\uff1f"}},a={},l=[{value:"\u4e00\u3001axios \u7684\u4f7f\u7528",id:"\u4e00axios-\u7684\u4f7f\u7528",level:2},{value:"\u4e8c\u3001\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7248 axios",id:"\u4e8c\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7248-axios",level:2},{value:"\u4e09\u3001\u6e90\u7801\u5206\u6790",id:"\u4e09\u6e90\u7801\u5206\u6790",level:2},{value:"\u5c0f\u7ed3",id:"\u5c0f\u7ed3",level:3},{value:"\u53c2\u8003\u6587\u732e",id:"\u53c2\u8003\u6587\u732e",level:2}];function d(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h2,{id:"\u4e00axios-\u7684\u4f7f\u7528",children:"\u4e00\u3001axios \u7684\u4f7f\u7528"}),"\n",(0,s.jsxs)(e.p,{children:["\u5173\u4e8e",(0,s.jsx)(e.code,{children:"axios"}),"\u7684\u57fa\u672c\u4f7f\u7528\uff0c\u4e0a\u7bc7\u6587\u7ae0\u5df2\u7ecf\u6709\u6240\u6d89\u53ca\uff0c\u8fd9\u91cc\u518d\u7a0d\u5fae\u56de\u987e\u4e0b\uff1a"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u53d1\u9001\u8bf7\u6c42"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"import axios from 'axios';\r\n\r\naxios(config) // \u76f4\u63a5\u4f20\u5165\u914d\u7f6e\r\naxios(url[, config]) // \u4f20\u5165url\u548c\u914d\u7f6e\r\naxios[method](url[, option]) // \u76f4\u63a5\u8c03\u7528\u8bf7\u6c42\u65b9\u5f0f\u65b9\u6cd5\uff0c\u4f20\u5165url\u548c\u914d\u7f6e\r\naxios[method](url[, data[, option]]) // \u76f4\u63a5\u8c03\u7528\u8bf7\u6c42\u65b9\u5f0f\u65b9\u6cd5\uff0c\u4f20\u5165data\u3001url\u548c\u914d\u7f6e\r\naxios.request(option) // \u8c03\u7528 request \u65b9\u6cd5\r\n\r\nconst axiosInstance = axios.create(config)\r\n// axiosInstance \u4e5f\u5177\u6709\u4ee5\u4e0a axios \u7684\u80fd\u529b\r\n\r\naxios.all([axiosInstance1, axiosInstance2]).then(axios.spread(response1, response2))\r\n// \u8c03\u7528 all \u548c\u4f20\u5165 spread \u56de\u8c03\r\n\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u8bf7\u6c42\u62e6\u622a\u5668"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"axios.interceptors.request.use(\r\n  function (config) {\r\n    // \u8fd9\u91cc\u5199\u53d1\u9001\u8bf7\u6c42\u524d\u5904\u7406\u7684\u4ee3\u7801\r\n    return config;\r\n  },\r\n  function (error) {\r\n    // \u8fd9\u91cc\u5199\u53d1\u9001\u8bf7\u6c42\u9519\u8bef\u76f8\u5173\u7684\u4ee3\u7801\r\n    return Promise.reject(error);\r\n  }\r\n);\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u54cd\u5e94\u62e6\u622a\u5668"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"axios.interceptors.response.use(\r\n  function (response) {\r\n    // \u8fd9\u91cc\u5199\u5f97\u5230\u54cd\u5e94\u6570\u636e\u540e\u5904\u7406\u7684\u4ee3\u7801\r\n    return response;\r\n  },\r\n  function (error) {\r\n    // \u8fd9\u91cc\u5199\u5f97\u5230\u9519\u8bef\u54cd\u5e94\u5904\u7406\u7684\u4ee3\u7801\r\n    return Promise.reject(error);\r\n  }\r\n);\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u53d6\u6d88\u8bf7\u6c42"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// \u65b9\u5f0f\u4e00\r\nconst CancelToken = axios.CancelToken;\r\nconst source = CancelToken.source();\r\n\r\naxios.get("xxxx", {\r\n  cancelToken: source.token,\r\n});\r\n// \u53d6\u6d88\u8bf7\u6c42 (\u8bf7\u6c42\u539f\u56e0\u662f\u53ef\u9009\u7684)\r\nsource.cancel("\u4e3b\u52a8\u53d6\u6d88\u8bf7\u6c42");\r\n\r\n// \u65b9\u5f0f\u4e8c\r\nconst CancelToken = axios.CancelToken;\r\nlet cancel;\r\n\r\naxios.get("xxxx", {\r\n  cancelToken: new CancelToken(function executor(c) {\r\n    cancel = c;\r\n  }),\r\n});\r\ncancel("\u4e3b\u52a8\u53d6\u6d88\u8bf7\u6c42");\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u4e8c\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7248-axios",children:"\u4e8c\u3001\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7248 axios"}),"\n",(0,s.jsxs)(e.p,{children:["\u6784\u5efa\u4e00\u4e2a",(0,s.jsx)(e.code,{children:"Axios"}),"\u6784\u9020\u51fd\u6570\uff0c\u6838\u5fc3\u4ee3\u7801\u4e3a",(0,s.jsx)(e.code,{children:"request"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'class Axios {\r\n  constructor() {}\r\n\r\n  request(config) {\r\n    return new Promise((resolve) => {\r\n      const { url = "", method = "get", data = {} } = config;\r\n      // \u53d1\u9001ajax\u8bf7\u6c42\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.open(method, url, true);\r\n      xhr.onload = function () {\r\n        console.log(xhr.responseText);\r\n        resolve(xhr.responseText);\r\n      };\r\n      xhr.send(data);\r\n    });\r\n  }\r\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u5bfc\u51fa",(0,s.jsx)(e.code,{children:"axios"}),"\u5b9e\u4f8b"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"// \u6700\u7ec8\u5bfc\u51faaxios\u7684\u65b9\u6cd5\uff0c\u5373\u5b9e\u4f8b\u7684request\u65b9\u6cd5\r\nfunction CreateAxiosFn() {\r\n  let axios = new Axios();\r\n  let req = axios.request.bind(axios);\r\n  return req;\r\n}\r\n\r\n// \u5f97\u5230\u6700\u540e\u7684\u5168\u5c40\u53d8\u91cfaxios\r\nlet axios = CreateAxiosFn();\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0a\u8ff0\u5c31\u5df2\u7ecf\u80fd\u591f\u5b9e\u73b0",(0,s.jsx)(e.code,{children:"axios({ })"}),"\u8fd9\u79cd\u65b9\u5f0f\u7684\u8bf7\u6c42"]}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0b\u9762\u662f\u6765\u5b9e\u73b0\u4e0b",(0,s.jsx)(e.code,{children:"axios.method()"}),"\u8fd9\u79cd\u5f62\u5f0f\u7684\u8bf7\u6c42"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// \u5b9a\u4e49get,post...\u65b9\u6cd5\uff0c\u6302\u5728\u5230Axios\u539f\u578b\u4e0a\r\nconst methodsArr = ["get", "delete", "head", "options", "put", "patch", "post"];\r\nmethodsArr.forEach((met) => {\r\n  Axios.prototype[met] = function () {\r\n    console.log("\u6267\u884c" + met + "\u65b9\u6cd5");\r\n    // \u5904\u7406\u5355\u4e2a\u65b9\u6cd5\r\n    if (["get", "delete", "head", "options"].includes(met)) {\r\n      // 2\u4e2a\u53c2\u6570(url[, config])\r\n      return this.request({\r\n        method: met,\r\n        url: arguments[0],\r\n        ...(arguments[1] || {}),\r\n      });\r\n    } else {\r\n      // 3\u4e2a\u53c2\u6570(url[,data[,config]])\r\n      return this.request({\r\n        method: met,\r\n        url: arguments[0],\r\n        data: arguments[1] || {},\r\n        ...(arguments[2] || {}),\r\n      });\r\n    }\r\n  };\r\n});\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u5c06",(0,s.jsx)(e.code,{children:"Axios.prototype"}),"\u4e0a\u7684\u65b9\u6cd5\u642c\u8fd0\u5230",(0,s.jsx)(e.code,{children:"request"}),"\u4e0a"]}),"\n",(0,s.jsxs)(e.p,{children:["\u9996\u5148\u5b9e\u73b0\u4e2a\u5de5\u5177\u7c7b\uff0c\u5b9e\u73b0\u5c06",(0,s.jsx)(e.code,{children:"b"}),"\u65b9\u6cd5\u6df7\u5165\u5230",(0,s.jsx)(e.code,{children:"a"}),"\uff0c\u5e76\u4e14\u4fee\u6539",(0,s.jsx)(e.code,{children:"this"}),"\u6307\u5411"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'const utils = {\r\n  extend(a, b, context) {\r\n    for (let key in b) {\r\n      if (b.hasOwnProperty(key)) {\r\n        if (typeof b[key] === "function") {\r\n          a[key] = b[key].bind(context);\r\n        } else {\r\n          a[key] = b[key];\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u4fee\u6539\u5bfc\u51fa\u7684\u65b9\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"function CreateAxiosFn() {\r\n  let axios = new Axios();\r\n\r\n  let req = axios.request.bind(axios);\r\n  // \u589e\u52a0\u4ee3\u7801\r\n  utils.extend(req, Axios.prototype, axios);\r\n\r\n  return req;\r\n}\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6784\u5efa\u62e6\u622a\u5668\u7684\u6784\u9020\u51fd\u6570"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"class InterceptorsManage {\r\n  constructor() {\r\n    this.handlers = [];\r\n  }\r\n\r\n  use(fullfield, rejected) {\r\n    this.handlers.push({\r\n      fullfield,\r\n      rejected,\r\n    });\r\n  }\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5b9e\u73b0",(0,s.jsx)(e.code,{children:"axios.interceptors.response.use"}),"\u548c",(0,s.jsx)(e.code,{children:"axios.interceptors.request.use"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"class Axios {\r\n    constructor() {\r\n        // \u65b0\u589e\u4ee3\u7801\r\n        this.interceptors = {\r\n            request: new InterceptorsManage,\r\n            response: new InterceptorsManage\r\n        }\r\n    }\r\n\r\n    request(config) {\r\n \t\t...\r\n    }\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6267\u884c\u8bed\u53e5",(0,s.jsx)(e.code,{children:"axios.interceptors.response.use"}),"\u548c",(0,s.jsx)(e.code,{children:"axios.interceptors.request.use"}),"\u7684\u65f6\u5019\uff0c\u5b9e\u73b0\u83b7\u53d6",(0,s.jsx)(e.code,{children:"axios"}),"\u5b9e\u4f8b\u4e0a\u7684",(0,s.jsx)(e.code,{children:"interceptors"}),"\u5bf9\u8c61\uff0c\u7136\u540e\u518d\u83b7\u53d6",(0,s.jsx)(e.code,{children:"response"}),"\u6216",(0,s.jsx)(e.code,{children:"request"}),"\u62e6\u622a\u5668\uff0c\u518d\u6267\u884c\u5bf9\u5e94\u7684\u62e6\u622a\u5668\u7684",(0,s.jsx)(e.code,{children:"use"}),"\u65b9\u6cd5"]}),"\n",(0,s.jsxs)(e.p,{children:["\u628a",(0,s.jsx)(e.code,{children:"Axios"}),"\u4e0a\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u642c\u5230",(0,s.jsx)(e.code,{children:"request"}),"\u8fc7\u53bb"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"function CreateAxiosFn() {\r\n  let axios = new Axios();\r\n\r\n  let req = axios.request.bind(axios);\r\n  // \u6df7\u5165\u65b9\u6cd5\uff0c \u5904\u7406axios\u7684request\u65b9\u6cd5\uff0c\u4f7f\u4e4b\u62e5\u6709get,post...\u65b9\u6cd5\r\n  utils.extend(req, Axios.prototype, axios);\r\n  // \u65b0\u589e\u4ee3\u7801\r\n  utils.extend(req, axios);\r\n  return req;\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u73b0\u5728",(0,s.jsx)(e.code,{children:"request"}),"\u4e5f\u6709\u4e86",(0,s.jsx)(e.code,{children:"interceptors"}),"\u5bf9\u8c61\uff0c\u5728\u53d1\u9001\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u4f1a\u5148\u83b7\u53d6",(0,s.jsx)(e.code,{children:"request"}),"\u62e6\u622a\u5668\u7684",(0,s.jsx)(e.code,{children:"handlers"}),"\u7684\u65b9\u6cd5\u6765\u6267\u884c"]}),"\n",(0,s.jsxs)(e.p,{children:["\u9996\u5148\u5c06\u6267\u884c",(0,s.jsx)(e.code,{children:"ajax"}),"\u7684\u8bf7\u6c42\u5c01\u88c5\u6210\u4e00\u4e2a\u65b9\u6cd5"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"request(config) {\r\n    this.sendAjax(config)\r\n}\r\nsendAjax(config){\r\n    return new Promise(resolve => {\r\n        const {url = '', method = 'get', data = {}} = config;\r\n        // \u53d1\u9001ajax\u8bf7\u6c42\r\n        console.log(config);\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open(method, url, true);\r\n        xhr.onload = function() {\r\n            console.log(xhr.responseText)\r\n            resolve(xhr.responseText);\r\n        };\r\n        xhr.send(data);\r\n    })\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u83b7\u5f97",(0,s.jsx)(e.code,{children:"handlers"}),"\u4e2d\u7684\u56de\u8c03"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"request(config) {\r\n    // \u62e6\u622a\u5668\u548c\u8bf7\u6c42\u7ec4\u88c5\u961f\u5217\r\n    let chain = [this.sendAjax.bind(this), undefined] // \u6210\u5bf9\u51fa\u73b0\u7684\uff0c\u5931\u8d25\u56de\u8c03\u6682\u65f6\u4e0d\u5904\u7406\r\n\r\n    // \u8bf7\u6c42\u62e6\u622a\r\n    this.interceptors.request.handlers.forEach(interceptor => {\r\n        chain.unshift(interceptor.fullfield, interceptor.rejected)\r\n    })\r\n\r\n    // \u54cd\u5e94\u62e6\u622a\r\n    this.interceptors.response.handlers.forEach(interceptor => {\r\n        chain.push(interceptor.fullfield, interceptor.rejected)\r\n    })\r\n\r\n    // \u6267\u884c\u961f\u5217\uff0c\u6bcf\u6b21\u6267\u884c\u4e00\u5bf9\uff0c\u5e76\u7ed9promise\u8d4b\u6700\u65b0\u7684\u503c\r\n    let promise = Promise.resolve(config);\r\n    while(chain.length > 0) {\r\n        promise = promise.then(chain.shift(), chain.shift())\r\n    }\r\n    return promise;\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"chains"}),"\u5927\u6982\u662f",(0,s.jsx)(e.code,{children:"['fulfilled1','reject1','fulfilled2','reject2','this.sendAjax','undefined','fulfilled2','reject2','fulfilled1','reject1']"}),"\u8fd9\u79cd\u5f62\u5f0f"]}),"\n",(0,s.jsxs)(e.p,{children:["\u8fd9\u6837\u5c31\u80fd\u591f\u6210\u529f\u5b9e\u73b0\u4e00\u4e2a\u7b80\u6613\u7248",(0,s.jsx)(e.code,{children:"axios"})]}),"\n",(0,s.jsx)(e.h2,{id:"\u4e09\u6e90\u7801\u5206\u6790",children:"\u4e09\u3001\u6e90\u7801\u5206\u6790"}),"\n",(0,s.jsx)(e.p,{children:"\u9996\u5148\u770b\u770b\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://static.vue-js.com/9d90eaa0-48b6-11eb-85f6-6fac77c0c9b3.png",alt:""})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"axios"}),"\u53d1\u9001\u8bf7\u6c42\u6709\u5f88\u591a\u5b9e\u73b0\u7684\u65b9\u6cd5\uff0c\u5b9e\u73b0\u5165\u53e3\u6587\u4ef6\u4e3a",(0,s.jsx)(e.code,{children:"axios.js "})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"function createInstance(defaultConfig) {\r\n  var context = new Axios(defaultConfig);\r\n\r\n  // instance\u6307\u5411\u4e86request\u65b9\u6cd5\uff0c\u4e14\u4e0a\u4e0b\u6587\u6307\u5411context\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4ee5 instance(option) \u65b9\u5f0f\u8c03\u7528\r\n  // Axios.prototype.request \u5185\u5bf9\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u6570\u636e\u7c7b\u578b\u5224\u65ad\uff0c\u4f7f\u6211\u4eec\u80fd\u591f\u4ee5 instance(url, option) \u65b9\u5f0f\u8c03\u7528\r\n  var instance = bind(Axios.prototype.request, context);\r\n\r\n  // \u628aAxios.prototype\u4e0a\u7684\u65b9\u6cd5\u6269\u5c55\u5230instance\u5bf9\u8c61\u4e0a\uff0c\r\n  // \u5e76\u6307\u5b9a\u4e0a\u4e0b\u6587\u4e3acontext\uff0c\u8fd9\u6837\u6267\u884cAxios\u539f\u578b\u94fe\u4e0a\u7684\u65b9\u6cd5\u65f6\uff0cthis\u4f1a\u6307\u5411context\r\n  utils.extend(instance, Axios.prototype, context);\r\n\r\n  // Copy context to instance\r\n  // \u628acontext\u5bf9\u8c61\u4e0a\u7684\u81ea\u8eab\u5c5e\u6027\u548c\u65b9\u6cd5\u6269\u5c55\u5230instance\u4e0a\r\n  // \u6ce8\uff1a\u56e0\u4e3aextend\u5185\u90e8\u4f7f\u7528\u7684forEach\u65b9\u6cd5\u5bf9\u5bf9\u8c61\u505afor in \u904d\u5386\u65f6\uff0c\u53ea\u904d\u5386\u5bf9\u8c61\u672c\u8eab\u7684\u5c5e\u6027\uff0c\u800c\u4e0d\u4f1a\u904d\u5386\u539f\u578b\u94fe\u4e0a\u7684\u5c5e\u6027\r\n  // \u8fd9\u6837\uff0cinstance \u5c31\u6709\u4e86  defaults\u3001interceptors \u5c5e\u6027\u3002\r\n  utils.extend(instance, context);\r\n  return instance;\r\n}\r\n\r\n// Create the default instance to be exported \u521b\u5efa\u4e00\u4e2a\u7531\u9ed8\u8ba4\u914d\u7f6e\u751f\u6210\u7684axios\u5b9e\u4f8b\r\nvar axios = createInstance(defaults);\r\n\r\n// Factory for creating new instances \u6269\u5c55axios.create\u5de5\u5382\u51fd\u6570\uff0c\u5185\u90e8\u4e5f\u662f createInstance\r\naxios.create = function create(instanceConfig) {\r\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\r\n};\r\n\r\n// Expose all/spread\r\naxios.all = function all(promises) {\r\n  return Promise.all(promises);\r\n};\r\n\r\naxios.spread = function spread(callback) {\r\n  return function wrap(arr) {\r\n    return callback.apply(null, arr);\r\n  };\r\n};\r\nmodule.exports = axios;\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4e3b\u8981\u6838\u5fc3\u662f ",(0,s.jsx)(e.code,{children:"Axios.prototype.request"}),"\uff0c\u5404\u79cd\u8bf7\u6c42\u65b9\u5f0f\u7684\u8c03\u7528\u5b9e\u73b0\u90fd\u662f\u5728 ",(0,s.jsx)(e.code,{children:"request"})," \u5185\u90e8\u5b9e\u73b0\u7684\uff0c \u7b80\u5355\u770b\u4e0b ",(0,s.jsx)(e.code,{children:"request"})," \u7684\u903b\u8f91"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'Axios.prototype.request = function request(config) {\r\n  // Allow for axios(\'example/url\'[, config]) a la fetch API\r\n  // \u5224\u65ad config \u53c2\u6570\u662f\u5426\u662f \u5b57\u7b26\u4e32\uff0c\u5982\u679c\u662f\u5219\u8ba4\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f URL\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u771f\u6b63\u7684config\r\n  if (typeof config === "string") {\r\n    config = arguments[1] || {};\r\n    // \u628a url \u653e\u7f6e\u5230 config \u5bf9\u8c61\u4e2d\uff0c\u4fbf\u4e8e\u4e4b\u540e\u7684 mergeConfig\r\n    config.url = arguments[0];\r\n  } else {\r\n    // \u5982\u679c config \u53c2\u6570\u662f\u5426\u662f \u5b57\u7b26\u4e32\uff0c\u5219\u6574\u4f53\u90fd\u5f53\u505aconfig\r\n    config = config || {};\r\n  }\r\n  // \u5408\u5e76\u9ed8\u8ba4\u914d\u7f6e\u548c\u4f20\u5165\u7684\u914d\u7f6e\r\n  config = mergeConfig(this.defaults, config);\r\n  // \u8bbe\u7f6e\u8bf7\u6c42\u65b9\u6cd5\r\n  config.method = config.method ? config.method.toLowerCase() : "get";\r\n  /*\r\n    something... \u6b64\u90e8\u5206\u4f1a\u5728\u540e\u7eed\u62e6\u622a\u5668\u5355\u72ec\u8bb2\u8ff0\r\n  */\r\n};\r\n\r\n// \u5728 Axios \u539f\u578b\u4e0a\u6302\u8f7d \'delete\', \'get\', \'head\', \'options\' \u4e14\u4e0d\u4f20\u53c2\u7684\u8bf7\u6c42\u65b9\u6cd5\uff0c\u5b9e\u73b0\u5185\u90e8\u4e5f\u662f request\r\nutils.forEach(\r\n  ["delete", "get", "head", "options"],\r\n  function forEachMethodNoData(method) {\r\n    Axios.prototype[method] = function (url, config) {\r\n      return this.request(\r\n        utils.merge(config || {}, {\r\n          method: method,\r\n          url: url,\r\n        })\r\n      );\r\n    };\r\n  }\r\n);\r\n\r\n// \u5728 Axios \u539f\u578b\u4e0a\u6302\u8f7d \'post\', \'put\', \'patch\' \u4e14\u4f20\u53c2\u7684\u8bf7\u6c42\u65b9\u6cd5\uff0c\u5b9e\u73b0\u5185\u90e8\u540c\u6837\u4e5f\u662f request\r\nutils.forEach(["post", "put", "patch"], function forEachMethodWithData(method) {\r\n  Axios.prototype[method] = function (url, data, config) {\r\n    return this.request(\r\n      utils.merge(config || {}, {\r\n        method: method,\r\n        url: url,\r\n        data: data,\r\n      })\r\n    );\r\n  };\r\n});\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"request"}),"\u5165\u53e3\u53c2\u6570\u4e3a",(0,s.jsx)(e.code,{children:"config"}),"\uff0c\u53ef\u4ee5\u8bf4",(0,s.jsx)(e.code,{children:"config"}),"\u8d2f\u5f7b\u4e86",(0,s.jsx)(e.code,{children:"axios"}),"\u7684\u4e00\u751f"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"axios"})," \u4e2d\u7684 ",(0,s.jsx)(e.code,{children:"config "}),"\u4e3b\u8981\u5206\u5e03\u5728\u8fd9\u51e0\u4e2a\u5730\u65b9\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u9ed8\u8ba4\u914d\u7f6e ",(0,s.jsx)(e.code,{children:"defaults.js"})]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"config.method"}),"\u9ed8\u8ba4\u4e3a ",(0,s.jsx)(e.code,{children:"get"})]}),"\n",(0,s.jsxs)(e.li,{children:["\u8c03\u7528 ",(0,s.jsx)(e.code,{children:"createInstance"})," \u65b9\u6cd5\u521b\u5efa ",(0,s.jsx)(e.code,{children:"axios "}),"\u5b9e\u4f8b\uff0c\u4f20\u5165\u7684",(0,s.jsx)(e.code,{children:"config"})]}),"\n",(0,s.jsxs)(e.li,{children:["\u76f4\u63a5\u6216\u95f4\u63a5\u8c03\u7528 ",(0,s.jsx)(e.code,{children:"request"})," \u65b9\u6cd5\uff0c\u4f20\u5165\u7684 ",(0,s.jsx)(e.code,{children:"config"})]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// axios.js\r\n// \u521b\u5efa\u4e00\u4e2a\u7531\u9ed8\u8ba4\u914d\u7f6e\u751f\u6210\u7684axios\u5b9e\u4f8b\r\nvar axios = createInstance(defaults);\r\n\r\n// \u6269\u5c55axios.create\u5de5\u5382\u51fd\u6570\uff0c\u5185\u90e8\u4e5f\u662f createInstance\r\naxios.create = function create(instanceConfig) {\r\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\r\n};\r\n\r\n// Axios.js\r\n// \u5408\u5e76\u9ed8\u8ba4\u914d\u7f6e\u548c\u4f20\u5165\u7684\u914d\u7f6e\r\nconfig = mergeConfig(this.defaults, config);\r\n// \u8bbe\u7f6e\u8bf7\u6c42\u65b9\u6cd5\r\nconfig.method = config.method ? config.method.toLowerCase() : "get";\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u4ece\u6e90\u7801\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u4f18\u5148\u7ea7\uff1a\u9ed8\u8ba4\u914d\u7f6e\u5bf9\u8c61",(0,s.jsx)(e.code,{children:"default"})," < ",(0,s.jsx)(e.code,{children:"method:get"})," < ",(0,s.jsx)(e.code,{children:"Axios"}),"\u7684\u5b9e\u4f8b\u5c5e\u6027",(0,s.jsx)(e.code,{children:"this.default"})," < ",(0,s.jsx)(e.code,{children:"request"}),"\u53c2\u6570"]}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0b\u9762\u91cd\u70b9\u770b\u770b",(0,s.jsx)(e.code,{children:"request"}),"\u65b9\u6cd5"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"Axios.prototype.request = function request(config) {\r\n  /*\r\n    \u5148\u662f mergeConfig ... \u7b49\uff0c\u4e0d\u518d\u9610\u8ff0\r\n  */\r\n  // Hook up interceptors middleware \u521b\u5efa\u62e6\u622a\u5668\u94fe. dispatchRequest \u662f\u91cd\u4e2d\u4e4b\u91cd\uff0c\u540e\u7eed\u91cd\u70b9\r\n  var chain = [dispatchRequest, undefined];\r\n\r\n  // push\u5404\u4e2a\u62e6\u622a\u5668\u65b9\u6cd5 \u6ce8\u610f\uff1ainterceptor.fulfilled \u6216 interceptor.rejected \u662f\u53ef\u80fd\u4e3aundefined\r\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(\r\n    interceptor\r\n  ) {\r\n    // \u8bf7\u6c42\u62e6\u622a\u5668\u9006\u5e8f \u6ce8\u610f\u6b64\u5904\u7684 forEach \u662f\u81ea\u5b9a\u4e49\u7684\u62e6\u622a\u5668\u7684forEach\u65b9\u6cd5\r\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\r\n  });\r\n\r\n  this.interceptors.response.forEach(function pushResponseInterceptors(\r\n    interceptor\r\n  ) {\r\n    // \u54cd\u5e94\u62e6\u622a\u5668\u987a\u5e8f \u6ce8\u610f\u6b64\u5904\u7684 forEach \u662f\u81ea\u5b9a\u4e49\u7684\u62e6\u622a\u5668\u7684forEach\u65b9\u6cd5\r\n    chain.push(interceptor.fulfilled, interceptor.rejected);\r\n  });\r\n\r\n  // \u521d\u59cb\u5316\u4e00\u4e2apromise\u5bf9\u8c61\uff0c\u72b6\u6001\u4e3aresolved\uff0c\u63a5\u6536\u5230\u7684\u53c2\u6570\u4e3a\u5df2\u7ecf\u5904\u7406\u5408\u5e76\u8fc7\u7684config\u5bf9\u8c61\r\n  var promise = Promise.resolve(config);\r\n\r\n  // \u5faa\u73af\u62e6\u622a\u5668\u7684\u94fe\r\n  while (chain.length) {\r\n    promise = promise.then(chain.shift(), chain.shift()); // \u6bcf\u4e00\u6b21\u5411\u5916\u5f39\u51fa\u62e6\u622a\u5668\r\n  }\r\n  // \u8fd4\u56de promise\r\n  return promise;\r\n};\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u62e6\u622a\u5668",(0,s.jsx)(e.code,{children:"interceptors"}),"\u662f\u5728\u6784\u5efa",(0,s.jsx)(e.code,{children:"axios"}),"\u5b9e\u4f8b\u5316\u7684\u5c5e\u6027"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"function Axios(instanceConfig) {\r\n  this.defaults = instanceConfig;\r\n  this.interceptors = {\r\n    request: new InterceptorManager(), // \u8bf7\u6c42\u62e6\u622a\r\n    response: new InterceptorManager(), // \u54cd\u5e94\u62e6\u622a\r\n  };\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"InterceptorManager"}),"\u6784\u9020\u51fd\u6570"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"// \u62e6\u622a\u5668\u7684\u521d\u59cb\u5316 \u5176\u5b9e\u5c31\u662f\u4e00\u7ec4\u94a9\u5b50\u51fd\u6570\r\nfunction InterceptorManager() {\r\n  this.handlers = [];\r\n}\r\n\r\n// \u8c03\u7528\u62e6\u622a\u5668\u5b9e\u4f8b\u7684use\u65f6\u5c31\u662f\u5f80\u94a9\u5b50\u51fd\u6570\u4e2dpush\u65b9\u6cd5\r\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\r\n  this.handlers.push({\r\n    fulfilled: fulfilled,\r\n    rejected: rejected,\r\n  });\r\n  return this.handlers.length - 1;\r\n};\r\n\r\n// \u62e6\u622a\u5668\u662f\u53ef\u4ee5\u53d6\u6d88\u7684\uff0c\u6839\u636euse\u7684\u65f6\u5019\u8fd4\u56de\u7684ID\uff0c\u628a\u67d0\u4e00\u4e2a\u62e6\u622a\u5668\u65b9\u6cd5\u7f6e\u4e3anull\r\n// \u4e0d\u80fd\u7528 splice \u6216\u8005 slice \u7684\u539f\u56e0\u662f \u5220\u9664\u4e4b\u540e id \u5c31\u4f1a\u53d8\u5316\uff0c\u5bfc\u81f4\u4e4b\u540e\u7684\u987a\u5e8f\u6216\u8005\u662f\u64cd\u4f5c\u4e0d\u53ef\u63a7\r\nInterceptorManager.prototype.eject = function eject(id) {\r\n  if (this.handlers[id]) {\r\n    this.handlers[id] = null;\r\n  }\r\n};\r\n\r\n// \u8fd9\u5c31\u662f\u5728 Axios\u7684request\u65b9\u6cd5\u4e2d \u4e2d\u5faa\u73af\u62e6\u622a\u5668\u7684\u65b9\u6cd5 forEach \u5faa\u73af\u6267\u884c\u94a9\u5b50\u51fd\u6570\r\nInterceptorManager.prototype.forEach = function forEach(fn) {\r\n  utils.forEach(this.handlers, function forEachHandler(h) {\r\n    if (h !== null) {\r\n      fn(h);\r\n    }\r\n  });\r\n};\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u8bf7\u6c42\u62e6\u622a\u5668\u65b9\u6cd5\u662f\u88ab ",(0,s.jsx)(e.code,{children:"unshift"}),"\u5230\u62e6\u622a\u5668\u4e2d\uff0c\u54cd\u5e94\u62e6\u622a\u5668\u662f\u88ab",(0,s.jsx)(e.code,{children:"push"}),"\u5230\u62e6\u622a\u5668\u4e2d\u7684\u3002\u6700\u7ec8\u5b83\u4eec\u4f1a\u62fc\u63a5\u4e0a\u4e00\u4e2a\u53eb",(0,s.jsx)(e.code,{children:"dispatchRequest"}),"\u7684\u65b9\u6cd5\u88ab\u540e\u7eed\u7684 ",(0,s.jsx)(e.code,{children:"promise"})," \u987a\u5e8f\u6267\u884c"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'var utils = require("./../utils");\r\nvar transformData = require("./transformData");\r\nvar isCancel = require("../cancel/isCancel");\r\nvar defaults = require("../defaults");\r\nvar isAbsoluteURL = require("./../helpers/isAbsoluteURL");\r\nvar combineURLs = require("./../helpers/combineURLs");\r\n\r\n// \u5224\u65ad\u8bf7\u6c42\u662f\u5426\u5df2\u88ab\u53d6\u6d88\uff0c\u5982\u679c\u5df2\u7ecf\u88ab\u53d6\u6d88\uff0c\u629b\u51fa\u5df2\u53d6\u6d88\r\nfunction throwIfCancellationRequested(config) {\r\n  if (config.cancelToken) {\r\n    config.cancelToken.throwIfRequested();\r\n  }\r\n}\r\n\r\nmodule.exports = function dispatchRequest(config) {\r\n  throwIfCancellationRequested(config);\r\n\r\n  // \u5982\u679c\u5305\u542bbaseUrl, \u5e76\u4e14\u4e0d\u662fconfig.url\u7edd\u5bf9\u8def\u5f84\uff0c\u7ec4\u5408baseUrl\u4ee5\u53caconfig.url\r\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\r\n    // \u7ec4\u5408baseURL\u4e0eurl\u5f62\u6210\u5b8c\u6574\u7684\u8bf7\u6c42\u8def\u5f84\r\n    config.url = combineURLs(config.baseURL, config.url);\r\n  }\r\n\r\n  config.headers = config.headers || {};\r\n\r\n  // \u4f7f\u7528/lib/defaults.js\u4e2d\u7684transformRequest\u65b9\u6cd5\uff0c\u5bf9config.headers\u548cconfig.data\u8fdb\u884c\u683c\u5f0f\u5316\r\n  // \u6bd4\u5982\u5c06headers\u4e2d\u7684Accept\uff0cContent-Type\u7edf\u4e00\u5904\u7406\u6210\u5927\u5199\r\n  // \u6bd4\u5982\u5982\u679c\u8bf7\u6c42\u6b63\u6587\u662f\u4e00\u4e2aObject\u4f1a\u683c\u5f0f\u5316\u4e3aJSON\u5b57\u7b26\u4e32\uff0c\u5e76\u6dfb\u52a0application/json;charset=utf-8\u7684Content-Type\r\n  // \u7b49\u4e00\u7cfb\u5217\u64cd\u4f5c\r\n  config.data = transformData(\r\n    config.data,\r\n    config.headers,\r\n    config.transformRequest\r\n  );\r\n\r\n  // \u5408\u5e76\u4e0d\u540c\u914d\u7f6e\u7684headers\uff0cconfig.headers\u7684\u914d\u7f6e\u4f18\u5148\u7ea7\u66f4\u9ad8\r\n  config.headers = utils.merge(\r\n    config.headers.common || {},\r\n    config.headers[config.method] || {},\r\n    config.headers || {}\r\n  );\r\n\r\n  // \u5220\u9664headers\u4e2d\u7684method\u5c5e\u6027\r\n  utils.forEach(\r\n    ["delete", "get", "head", "post", "put", "patch", "common"],\r\n    function cleanHeaderConfig(method) {\r\n      delete config.headers[method];\r\n    }\r\n  );\r\n\r\n  // \u5982\u679cconfig\u914d\u7f6e\u4e86adapter\uff0c\u4f7f\u7528config\u4e2d\u914d\u7f6eadapter\u7684\u66ff\u4ee3\u9ed8\u8ba4\u7684\u8bf7\u6c42\u65b9\u6cd5\r\n  var adapter = config.adapter || defaults.adapter;\r\n\r\n  // \u4f7f\u7528adapter\u65b9\u6cd5\u53d1\u8d77\u8bf7\u6c42\uff08adapter\u6839\u636e\u6d4f\u89c8\u5668\u73af\u5883\u6216\u8005Node\u73af\u5883\u4f1a\u6709\u4e0d\u540c\uff09\r\n  return adapter(config).then(\r\n    // \u8bf7\u6c42\u6b63\u786e\u8fd4\u56de\u7684\u56de\u8c03\r\n    function onAdapterResolution(response) {\r\n      // \u5224\u65ad\u662f\u5426\u4ee5\u53ca\u53d6\u6d88\u4e86\u8bf7\u6c42\uff0c\u5982\u679c\u53d6\u6d88\u4e86\u8bf7\u6c42\u629b\u51fa\u4ee5\u53d6\u6d88\r\n      throwIfCancellationRequested(config);\r\n\r\n      // \u4f7f\u7528/lib/defaults.js\u4e2d\u7684transformResponse\u65b9\u6cd5\uff0c\u5bf9\u670d\u52a1\u5668\u8fd4\u56de\u7684\u6570\u636e\u8fdb\u884c\u683c\u5f0f\u5316\r\n      // \u4f8b\u5982\uff0c\u4f7f\u7528JSON.parse\u5bf9\u54cd\u5e94\u6b63\u6587\u8fdb\u884c\u89e3\u6790\r\n      response.data = transformData(\r\n        response.data,\r\n        response.headers,\r\n        config.transformResponse\r\n      );\r\n\r\n      return response;\r\n    },\r\n    // \u8bf7\u6c42\u5931\u8d25\u7684\u56de\u8c03\r\n    function onAdapterRejection(reason) {\r\n      if (!isCancel(reason)) {\r\n        throwIfCancellationRequested(config);\r\n\r\n        if (reason && reason.response) {\r\n          reason.response.data = transformData(\r\n            reason.response.data,\r\n            reason.response.headers,\r\n            config.transformResponse\r\n          );\r\n        }\r\n      }\r\n      return Promise.reject(reason);\r\n    }\r\n  );\r\n};\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u518d\u6765\u770b\u770b",(0,s.jsx)(e.code,{children:"axios"}),"\u662f\u5982\u4f55\u5b9e\u73b0\u53d6\u6d88\u8bf7\u6c42\u7684\uff0c\u5b9e\u73b0\u6587\u4ef6\u5728",(0,s.jsx)(e.code,{children:"CancelToken.js"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'function CancelToken(executor) {\r\n  if (typeof executor !== "function") {\r\n    throw new TypeError("executor must be a function.");\r\n  }\r\n  // \u5728 CancelToken \u4e0a\u5b9a\u4e49\u4e00\u4e2a pending \u72b6\u6001\u7684 promise \uff0c\u5c06 resolve \u56de\u8c03\u8d4b\u503c\u7ed9\u5916\u90e8\u53d8\u91cf resolvePromise\r\n  var resolvePromise;\r\n  this.promise = new Promise(function promiseExecutor(resolve) {\r\n    resolvePromise = resolve;\r\n  });\r\n\r\n  var token = this;\r\n  // \u7acb\u5373\u6267\u884c \u4f20\u5165\u7684 executor\u51fd\u6570\uff0c\u5c06\u771f\u5b9e\u7684 cancel \u65b9\u6cd5\u901a\u8fc7\u53c2\u6570\u4f20\u9012\u51fa\u53bb\u3002\r\n  // \u4e00\u65e6\u8c03\u7528\u5c31\u6267\u884c resolvePromise \u5373\u524d\u9762\u7684 promise \u7684 resolve\uff0c\u5c31\u66f4\u6539promise\u7684\u72b6\u6001\u4e3a resolve\u3002\r\n  // \u90a3\u4e48xhr\u4e2d\u5b9a\u4e49\u7684 CancelToken.promise.then\u65b9\u6cd5\u5c31\u4f1a\u6267\u884c, \u4ece\u800cxhr\u5185\u90e8\u4f1a\u53d6\u6d88\u8bf7\u6c42\r\n  executor(function cancel(message) {\r\n    // \u5224\u65ad\u8bf7\u6c42\u662f\u5426\u5df2\u7ecf\u53d6\u6d88\u8fc7\uff0c\u907f\u514d\u591a\u6b21\u6267\u884c\r\n    if (token.reason) {\r\n      return;\r\n    }\r\n    token.reason = new Cancel(message);\r\n    resolvePromise(token.reason);\r\n  });\r\n}\r\n\r\nCancelToken.source = function source() {\r\n  // source \u65b9\u6cd5\u5c31\u662f\u8fd4\u56de\u4e86\u4e00\u4e2a CancelToken \u5b9e\u4f8b\uff0c\u4e0e\u76f4\u63a5\u4f7f\u7528 new CancelToken \u662f\u4e00\u6837\u7684\u64cd\u4f5c\r\n  var cancel;\r\n  var token = new CancelToken(function executor(c) {\r\n    cancel = c;\r\n  });\r\n  // \u8fd4\u56de\u521b\u5efa\u7684 CancelToken \u5b9e\u4f8b\u4ee5\u53ca\u53d6\u6d88\u65b9\u6cd5\r\n  return {\r\n    token: token,\r\n    cancel: cancel,\r\n  };\r\n};\n'})}),"\n",(0,s.jsxs)(e.p,{children:["\u5b9e\u9645\u4e0a\u53d6\u6d88\u8bf7\u6c42\u7684\u64cd\u4f5c\u662f\u5728 ",(0,s.jsx)(e.code,{children:"xhr.js"})," \u4e2d\u4e5f\u6709\u54cd\u5e94\u7684\u914d\u5408\u7684"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"if (config.cancelToken) {\r\n  config.cancelToken.promise.then(function onCanceled(cancel) {\r\n    if (!request) {\r\n      return;\r\n    }\r\n    // \u53d6\u6d88\u8bf7\u6c42\r\n    request.abort();\r\n    reject(cancel);\r\n  });\r\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5de7\u5999\u7684\u5730\u65b9\u5728 ",(0,s.jsx)(e.code,{children:"CancelToken"}),"\u4e2d ",(0,s.jsx)(e.code,{children:"executor"})," \u51fd\u6570\uff0c\u901a\u8fc7",(0,s.jsx)(e.code,{children:"resolve"}),"\u51fd\u6570\u7684\u4f20\u9012\u4e0e\u6267\u884c\uff0c\u63a7\u5236",(0,s.jsx)(e.code,{children:"promise"}),"\u7684\u72b6\u6001"]}),"\n",(0,s.jsx)(e.h3,{id:"\u5c0f\u7ed3",children:"\u5c0f\u7ed3"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{src:"https://static.vue-js.com/b1d2ebd0-48b6-11eb-ab90-d9ae814b240d.png",alt:""})}),"\n",(0,s.jsx)(e.h2,{id:"\u53c2\u8003\u6587\u732e",children:"\u53c2\u8003\u6587\u732e"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://juejin.cn/post/6856706569263677447#heading-4",children:"https://juejin.cn/post/6856706569263677447#heading-4"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://juejin.cn/post/6844903907500490766",children:"https://juejin.cn/post/6844903907500490766"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://github.com/axios/axios",children:"https://github.com/axios/axios"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>c,x:()=>i});var s=r(96540);const o={},t=s.createContext(o);function c(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:c(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);