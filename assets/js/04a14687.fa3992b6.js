"use strict";(self.webpackChunkfn_wang_10_github_io=self.webpackChunkfn_wang_10_github_io||[]).push([[73748],{46880:(r,n,e)=>{e.r(n),e.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>p,toc:()=>d});var t=e(74848),o=e(28453);const s={},c=void 0,p={id:"React/Provider \u548c connect\u5206\u522b\u505a\u4e86\u4ec0\u4e48\u4e8b",title:"Provider \u548c connect\u5206\u522b\u505a\u4e86\u4ec0\u4e48\u4e8b",description:"react-redux \u662f\u7ed9 react \u9879\u76ee\u63d0\u4f9b\u7684\u72b6\u6001\u63d0\u5347\u548c\u5206\u53d1\u7684\u7b80\u5316\u64cd\u4f5c api=>Provider+connect\u3002",source:"@site/docs/React/Provider \u548c connect\u5206\u522b\u505a\u4e86\u4ec0\u4e48\u4e8b.md",sourceDirName:"React",slug:"/React/Provider \u548c connect\u5206\u522b\u505a\u4e86\u4ec0\u4e48\u4e8b",permalink:"/docs/React/Provider \u548c connect\u5206\u522b\u505a\u4e86\u4ec0\u4e48\u4e8b",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"reactSidebar",previous:{title:"Fiber\u7b97\u6cd5",permalink:"/docs/React/Fiber\u7b97\u6cd5"},next:{title:"PureComponent\u548cComponent\u7684\u533a\u522b",permalink:"/docs/React/PureComponent\u548cComponent\u7684\u533a\u522b"}},a={},d=[];function i(r){const n={br:"br",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["react-redux \u662f\u7ed9 react \u9879\u76ee\u63d0\u4f9b\u7684\u72b6\u6001\u63d0\u5347\u548c\u5206\u53d1\u7684\u7b80\u5316\u64cd\u4f5c api=>Provider+connect\u3002",(0,t.jsx)(n.br,{}),"\n","\u901a\u8fc7\u6700\u5916\u5c42 Provider \u7ec4\u4ef6\u5f00\u542f context\uff0c\u5c06\u5168\u5c40 store \u5185\u5bb9\u6253\u8fdb\u53bb\uff1b\u901a\u8fc7 connect \u9ad8\u9636\u7ec4\u4ef6\u83b7\u53d6 store \u5185\u5bb9\uff0c\u5e76\u5c06\u5176\u6253\u5165\u5230\u53c2\u6570\u7ec4\u4ef6\u7684 props \u4e2d\uff1b \u4e0a\u8ff0\u4e24\u8005\u5b8c\u6210\u4e86\u72b6\u6001\u63d0\u5347\u5230\u5168\u5c40\u548c\u72b6\u6001\u5206\u53d1\u3002"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"\u4ece react-redux \u4e2d\u89e3\u6784 Provider \u7ec4\u4ef6\uff0c\u5957\u5728 App \u7ec4\u4ef6\u7684\u5916\u9762\uff0cProvider \u7ec4\u4ef6\u6709\u4e00\u4e2a store \u5c5e\u6027"}),"\n",(0,t.jsxs)(n.li,{children:["\u5f15\u5165\u4ed3\u5e93\u5b9e\u4f8b\uff0c\u628a\u4ed3\u5e93\u5b9e\u4f8b\u4f5c\u4e3a Provider \u7ec4\u4ef6\u7684 store \u5c5e\u6027\u7684\u5c5e\u6027\u503c",(0,t.jsx)(n.br,{}),"\n","\u7ec4\u4ef6\u4f7f\u7528\u4ed3\u5e93"]}),"\n",(0,t.jsxs)(n.li,{children:["\u4ece react-redux \u4e2d \u89e3\u6784 connect \u51fd\u6570",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:'import {connect} from "react-redux"'})]}),"\n",(0,t.jsxs)(n.li,{children:["connect \u51fd\u6570\u6267\u884c\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff0c\u90fd\u662f\u7eaf\u51fd\u6570\uff08mapStateToProps,mapDispatchToProps\uff09",(0,t.jsx)(n.br,{}),"\n","connect \u51fd\u6570\u6267\u884c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6",(0,t.jsx)(n.br,{}),"\n","mapStateToProps \u2014\u2014\u2014\u2014 \u5c06\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u6620\u5c04\u5230\u7ec4\u4ef6\u7684 props \u4e2d",(0,t.jsx)(n.br,{}),"\n","mapDispatchToProps \u2014\u2014\u2014\u2014 \u5c06\u4ed3\u5e93\u4e2d\u7684\u65b9\u6cd5\u6620\u5c04\u5230\u7ec4\u4ef6\u7684 props \u4e2d"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"mapStateToProps"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:"// \u7b2c\u4e00\u4e2a\u51fd\u6570\u662f\u5c06\u4ed3\u5e93\u7684state\u7684\u6570\u636e\u6620\u5c04\u5230\u7ec4\u5efa\u7684props\u91cc\u9762\u53bb(\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2astate\u53c2\u6570\uff0cstate\u5c31\u662f\u4ed3\u5e93\u4e2d\u7684state)\r\n// \u8fd9\u4e2a\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u4f1a\u6620\u5c04\u5230\u7ec4\u4ef6\u7684props\u4e2d\u53bb\uff0c\u8fd9\u65f6\u7ec4\u4ef6\u7684props\u91cc\u9762\u5c31\u4f1a\u6709\u4e2acount\uff0c\u8fd9\u4e2acount\u4f1a\u548c\u4ed3\u5e93\u4e2d\u7684state\u4e2d\u7684count\u4fdd\u6301\u4e00\u81f4\uff08\u4ed3\u5e93\u4e2d\u7684state\u4e2d\u7684count\u76f4\u63a5\u6620\u5c04\u5230\u7ec4\u5efa\u7684props\u7684count\uff0c\u8fd9\u6837\u5b83\u4eec\u4e24\u8005\u5c31\u80fd\u4fdd\u6301\u4e00\u81f4\u4e86\uff0c\u4ed3\u5e93\u4e2d\u7684count\u5c31\u662f\u7ec4\u4ef6\u4e2d\u7684props\u7684count\u4e86\uff0c\u7ec4\u4ef6\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86\uff09\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    count: state.count,\r\n  };\r\n};\n"})}),"\n",(0,t.jsx)(n.p,{children:"mapDispatchToProps"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:'// \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5c06\u4ed3\u5e93\u7684dispatch\u51fd\u6570\u6620\u5c04\u5230\u7ec4\u4ef6\u7684props\u91cc\u9762\u53bb\uff08dispatch\u5c31\u662f\u6d3e\u53d1\u6539\u53d8\u4ed3\u5e93\u6570\u636e\u7684\u51fd\u6570\u7684\uff09\r\n// \u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\u662fdispatch\uff0c\u5c31\u662f\u4ed3\u5e93\u4e0b\u7684dispatch\u65b9\u6cd5\r\n// \u8fd9\u4e2a\u51fd\u6570\u4e5f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u4f1a\u6620\u5c04\u5230\u7ec4\u4ef6\u7684props\u4e2d\u53bb\uff0c\u8fd9\u65f6\u7ec4\u4ef6\u7684props\u91cc\u9762\u5c31\u4f1a\u6709add\u4e86\uff0c\u8fd9\u4e2aadd\u4f1a\u548c\u4ed3\u5e93\u4e2d\u7684dispatch\u4e2d\u7684increment\u4fdd\u6301\u4e00\u81f4\uff08\u4ed3\u5e93\u4e2d\u7684dispatch\u4e2d\u7684increment\u76f4\u63a5\u6620\u5c04\u5230\u7ec4\u5efa\u7684props\u7684add\uff0c\u8fd9\u6837\u5b83\u4eec\u4e24\u8005\u5c31\u80fd\u4fdd\u6301\u4e00\u81f4\u4e86\uff0c\u4ed3\u5e93\u4e2d\u7684increment\u5c31\u662f\u7ec4\u4ef6\u4e2d\u7684props\u7684add\u4e86\uff0c\u7ec4\u4ef6\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86\uff09\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    add: (num) => {\r\n      // dispatch({type:"increment",num});\r\n      dispatch(addAction(num));\r\n    },\r\n    minus(num) {\r\n      // dispatch({type:"decrement",num});\r\n      dispatch(minusAction(num));\r\n    },\r\n    load() {\r\n      dispatch(loadAction());\r\n    },\r\n  };\r\n};\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u76f4\u63a5\u5c06\u4ed3\u5e93\u5f15\u5230\u7ec4\u4ef6\u4e2d\u662f\u6ca1\u6709\u54cd\u5e94\u5f0f\u7684",(0,t.jsx)(n.br,{}),"\n","\u6709\u54cd\u5e94\u5f0f\u7684\u505a\u6cd5",(0,t.jsx)(n.br,{}),"\n","\u6839\u7ec4\u4ef6"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:'// 1. \u4ecereact-redux\u4e2d\u89e3\u6784Provider\u7ec4\u4ef6\uff0c\u5957\u5728App\u7ec4\u4ef6\u7684\u5916\u9762\uff0cProvider\u7ec4\u4ef6\u6709\u4e00\u4e2astore\u5c5e\u6027\r\n// 2. \u5f15\u5165\u4ed3\u5e93\u5b9e\u4f8b\uff0c\u628a\u4ed3\u5e93\u5b9e\u4f8b\u4f5c\u4e3aProvider\u7ec4\u4ef6\u7684store\u5c5e\u6027\u7684\u5c5e\u6027\u503c\r\nimport store from "./.....";\r\n<Provider store={store}></Provider>;\r\n// \u4f7f\u7528\u4ed3\u5e93\r\n// \u4ecereact-redux\u4e2d \u89e3\u6784connect\u51fd\u6570\r\nimport { connect } from "react-redux";\r\n// 4.connect\u51fd\u6570\u6267\u884c\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff0c\u90fd\u662f\u7eaf\u51fd\u6570\uff08mapStateToProps,mapDispatchToProps\uff09\r\n// connect\u51fd\u6570\u6267\u884c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6\r\n// mapStateToProps\u51fd\u6570\u6709\u4e00\u4e2astate\u53c2\u6570\uff0cstate\u5c31\u662f\u4ed3\u5e93\u4e2d\u7684defaultState\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    count: state.count,\r\n  };\r\n};\r\n// mapDispatchToProps\u51fd\u6570\u6709\u4e00\u4e2adispatch\u53c2\u6570\uff0cdispatch\u5c31\u662f\u4ed3\u5e93\u4e0b\u9762reducer\u91cc\u9762\u5b9a\u4e49\u7684\u65b9\u6cd5\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    add: () => {\r\n      dispatch({ type: "xxxx" });\r\n    },\r\n  };\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u4e5f\u53ef\u4ee5\u5199\u6210\u9ad8\u9636\u7ec4\u4ef6\u7684\u88c5\u9970\u5668\u7684\u5199\u6cd5",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"@connect(mapStateToProps\uff0cmapDispatchToProps)"}),"\uff0c\u8981\u5199\u5728\u7c7b\u7ec4\u4ef6\u7684\u4e0a\u9762\uff0c\u4e0d\u80fd\u5206\u5f00",(0,t.jsx)(n.br,{}),"\n","\u5982\u679c\u53ea\u4f7f\u7528\u4e00\u4e2a\u53c2\u6570\uff0c\u8981\u5199\u4e3a null\uff0c",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"@connect(null\uff0cmapDispatchToProps)"}),(0,t.jsx)(n.br,{}),"\n","\u5c06\u4ed3\u5e93\u4e2d\u7684\u6570\u636e\u6620\u5c04\u5230\u7ec4\u4ef6\u7684 props \u4e2d",(0,t.jsx)(n.br,{}),"\n","\u5c06\u4ed3\u5e93\u4e2d\u7684\u65b9\u6cd5\u6620\u5c04\u5230\u7ec4\u4ef6\u7684 props \u4e2d",(0,t.jsx)(n.br,{}),"\n","\u4f7f\u7528\u7684\u65f6\u5019\u76f4\u63a5 this,props.count this.props.xxx",(0,t.jsx)(n.br,{}),"\n","\u8fd9\u6837\u5199\u8fd9\u4e2a\u4ed3\u5e93\u7684\u6570\u636e\u5c31\u6709\u54cd\u5e94\u5f0f\u4e86"]}),"\n",(0,t.jsx)(n.p,{children:"redux \u7684\u5f02\u6b65"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:'// \u4f7f\u7528thunk\u5f02\u6b65\u5e93\r\n// applyMiddleware\u662f\u4e2d\u95f4\u4ef6,\u7528\u4e8e\u505aredux\u7684\u5f02\u6b65\r\nimport { createStore, applyMiddleware } from "redux";\r\nimport reducer from "./reducer";\r\n// \u5b89\u88c5\u5f02\u6b65\u5e93yarn add redux-thunk\r\n// \u5f15\u5165\u5f02\u6b65\u5e93\r\nimport thunk from "redux-thunk";\r\n// createStore\u65b9\u6cd5\u53ef\u4ee5\u63a5\u6536\u7b2c\u4e8c\u4e2a\u53c2\u6570\r\n// \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662fapplyMiddleware\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\r\n// applyMiddleware\u65b9\u6cd5\u9700\u8981\u63a5\u6536\u4e00\u4e2a\u5f02\u6b65\u5e93\u4f5c\u4e3a\u53c2\u6570\r\nconst store = createStore(reducer, applyMiddleware(thunk));\r\nexport default store;\r\n// thunk\u5f02\u6b65\u5e93\u7528\u7684\u4e0d\u591a\n'})})]})}function u(r={}){const{wrapper:n}={...(0,o.R)(),...r.components};return n?(0,t.jsx)(n,{...r,children:(0,t.jsx)(i,{...r})}):i(r)}},28453:(r,n,e)=>{e.d(n,{R:()=>c,x:()=>p});var t=e(96540);const o={},s=t.createContext(o);function c(r){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof r?r(n):{...n,...r}}),[n,r])}function p(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:c(r.components),t.createElement(s.Provider,{value:n},r.children)}}}]);